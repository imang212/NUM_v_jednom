<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Skvorovy kody NUM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="num_v_jednom_files/libs/clipboard/clipboard.min.js"></script>
<script src="num_v_jednom_files/libs/quarto-html/quarto.js"></script>
<script src="num_v_jednom_files/libs/quarto-html/popper.min.js"></script>
<script src="num_v_jednom_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="num_v_jednom_files/libs/quarto-html/anchor.min.js"></script>
<link href="num_v_jednom_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="num_v_jednom_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="num_v_jednom_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="num_v_jednom_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="num_v_jednom_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Skvorovy kody NUM</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style type="text/css">
#quarto-content {
  display: flex;
  align-content: center;
}
main {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}
.sourceCode code {
  white-space: pre-wrap;   /* umožní zalamování */
  word-break: break-word;  /* když je jedno slovo moc dlouhé */
}

.sourceCode {
  white-space: pre-wrap;   /* totéž pro pre blok */
  word-break: break-word;
  /*overflow-x: hidden;      /* schová posuvník */
}
/*.sourceCode code span{
/*  white-space: pre-wrap;   /* umožní zalamování */
/*  word-break: break-word;  /* když je jedno slovo moc dlouhé */
/*}

</style>
<hr>
<section id="řešení-soustav-lin.-rovnic-maticemi" class="level3">
<h3 class="anchored" data-anchor-id="řešení-soustav-lin.-rovnic-maticemi">Řešení soustav lin. rovnic (maticemi)</h3>
<section id="gausova-metoda-s-pivotem" class="level4">
<h4 class="anchored" data-anchor-id="gausova-metoda-s-pivotem">Gausova metoda (s pivotem)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Gauss <span class="ot">&lt;-</span> <span class="cf">function</span>(A,b){ <span class="co">#řešení lineárních rovnic Ax = b</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(b); Ab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A,b) <span class="co">#uprava původní matice A do horní trojúhelnikové formy pomocí přímého chodu, řešení rovnice zpětným chodem pro přímý chod</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#přímý chod (pro každý sloupec(k) zrušíme prvky pod diagonálou násobem a odečítáním řádků, výsledkem je (horní trojúhelníková matice pro zpětný chod)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#pivot - můžem dát pro vylepšení</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    max_row <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">abs</span>(Ab[(k<span class="sc">:</span>n),k]))<span class="sc">+</span>k<span class="dv">-1</span> <span class="co">#(maximální prvek v akt sloupci pod nebo na diagonale)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(max_row <span class="sc">!=</span> k){</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> k<span class="sc">:</span>(n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">&lt;-</span> Ab[k,j]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      Ab[k,j] <span class="ot">&lt;-</span> Ab[max_row,j]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      Ab[max_row,j] <span class="ot">&lt;-</span> temp</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>      c <span class="ot">&lt;-</span> <span class="sc">-</span>Ab[i,k]<span class="sc">/</span>Ab[k,k]</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>      Ab[i,j] <span class="ot">&lt;-</span> Ab[i,j] <span class="sc">+</span> c<span class="sc">*</span>Ab[k,j]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#zpětný chod (počítáme neznámé, začínáme od posledního řádku a postupujeme nahoru, postupně počítáme neznámé x pomocí horní trojúhelníkové matice)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> b</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  x[n] <span class="ot">&lt;-</span> Ab[n,n<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span>Ab[n,n]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> (Ab[i,n<span class="sc">+</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(Ab[i,(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]<span class="sc">*</span>x[(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]))<span class="sc">/</span>Ab[i,i]</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x) <span class="co">#vektor x, který je řešení soustavy lin. rovnic</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lu-dekompozice" class="level4">
<h4 class="anchored" data-anchor-id="lu-dekompozice">LU dekompozice</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>getLU <span class="ot">&lt;-</span> <span class="cf">function</span>(A){ <span class="co">#převední čtvercové matice A na kombinaci dolní trojúhelníkové matice L a horní trojúhelníkové matice U (A=LxU)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A) <span class="co"># prvky pod diagonálou matice A odpovídají matici L, zatímco prvky nad diagonálou tvořív matici U</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n <span class="co">#kaž. prvek pod diag A[i,k] je normalizován dělením A[k,k], což tvoří prvek L[i,k]</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      nasobek <span class="ot">&lt;-</span> A[i,k]<span class="sc">/</span>A[k,k]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      A[i,j] <span class="ot">&lt;-</span> A[i,j] <span class="sc">-</span> nasobek<span class="sc">*</span>A[k,j]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      A[i,k] <span class="ot">&lt;-</span> nasobek</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A) <span class="co">#pro výpoč determinantů a inverzních matic</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lu-dekompozice-řešení-soustavy-rovnic" class="level4">
<h4 class="anchored" data-anchor-id="lu-dekompozice-řešení-soustavy-rovnic">LU dekompozice (řešení soustavy rovnic)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>SolveLU <span class="ot">&lt;-</span> <span class="cf">function</span>(LU, b){  <span class="co">#rozložení matice A na LU, kde se postupně řeší dvě soustavy Ly=b(dopředná substituce) a Ux=y(zpětná substituce)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(b); y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dopředná substituce: řeší Ly = b (postupujeme od prvního řádku a počítáme hodnoty vektoru y)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> b[<span class="dv">1</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> b[i] <span class="sc">-</span> <span class="fu">sum</span>(LU[i,j] <span class="sc">*</span> y[j])</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Zpětná substituce: řeší Ux = y (postupujeme od posledního řádku a vzpočítáme vektor x)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  x[n] <span class="ot">&lt;-</span> y[n] <span class="sc">/</span> LU[n,n]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> (y[i] <span class="sc">-</span> <span class="fu">sum</span>(LU[i,j] <span class="sc">*</span> x[j])) <span class="sc">/</span> LU[i,i]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>n),n,n); b <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) <span class="co">#matice a vektor s random čísly podle n délky</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">solve</span>(A,b)) <span class="co">#pro kontrolu</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.55015236 -0.44538058  1.37975973 -0.04142748</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gauss</span>(A,b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.55015236 -0.44538058  1.37975973 -0.04142748</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#řešení LU dekompozice</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>LU <span class="ot">&lt;-</span> <span class="fu">getLU</span>(A)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">SolveLU</span>(LU,b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.55015236 -0.44538058  1.37975973 -0.04142748</code></pre>
</div>
</div>
</section>
<section id="gauss-seidel-řešení-soustavy-lin.-rovnic" class="level4">
<h4 class="anchored" data-anchor-id="gauss-seidel-řešení-soustavy-lin.-rovnic">Gauss seidel (řešení soustavy lin. rovnic)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>gaussseidel <span class="ot">&lt;-</span> <span class="cf">function</span>(A,b){ <span class="co">#A je matice koeficientů B je vektor pravých stran</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(b); x0 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{ <span class="co">#hlavní smyčka repeat, kde pro každý řádek i se aktualizuje hodnota x[i] podle vzorce pro Gauss-Seidelovu metodu (stačí 10 iterací) </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> (b[i]<span class="sc">-</span><span class="fu">sum</span>(A[i,]<span class="sc">*</span>x0)<span class="sc">+</span>A[i,i]<span class="sc">*</span>x0[i])<span class="sc">/</span>A[i,i] <span class="co"># každý řádek podle vzorce</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    Ax <span class="ot">&lt;-</span> A<span class="sc">%*%</span>x</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.nan</span>(Ax<span class="sc">-</span>b))){ <span class="cf">break</span> } <span class="co">#pokud se vyskytne Nan v matici Ax, výpočet končí s chybovou hláškou (kontroluje se podmínkou na rozdíl mezi Ac a b.)</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(A<span class="sc">%*%</span>x<span class="sc">-</span>b)) <span class="sc">&lt;</span> <span class="fl">0.0000000001</span>){<span class="fu">return</span>(x)} <span class="co">#x je řešení linerálního systému</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gauss-seidel-bez-vektorizace-2.-způsob" class="level4">
<h4 class="anchored" data-anchor-id="gauss-seidel-bez-vektorizace-2.-způsob">Gauss seidel (bez vektorizace) 2. způsob</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gaussseidel2 <span class="ot">&lt;-</span> <span class="cf">function</span>(A,b){ </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(b); x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){<span class="co">#pocet iteraci, staci 10,bez vek. znamená že má smyčku</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      soucet <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#promenna s 0</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(j<span class="sc">!=</span>i){ <span class="co">#kdyz j je jiny nez i takze j=1,...,i-1 (kriterium)</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>          soucet <span class="ot">&lt;-</span> soucet <span class="sc">+</span> A[i,j]<span class="sc">*</span>x[j] </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> (b[i]<span class="sc">-</span>soucet)<span class="sc">/</span>A[i,i] <span class="co">#Pro každý prvek x[i] se ručně sčítají, hodnoty A[i,j]*x[j] kromě diagionálního prvku A[i,i], x[i] se přepočítá podle vzorce pro Gauss-Seidel</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gauss-seidel-s-vektorizací" class="level4">
<h4 class="anchored" data-anchor-id="gauss-seidel-s-vektorizací">Gauss seidel (s vektorizací)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#s vektorizací (využívá maticových operací pro efektivnější výpočet, Rozdělení matice A na diagonální, dolní a horní část)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>gaussseidel3 <span class="ot">&lt;-</span> <span class="cf">function</span>(A,b){</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(b); x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){ <span class="co">#vektorizace sum(A[i,]*x provádí součet vektorového součinu na jeden řádek, což je efektivnější než ruční sčitání</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) x[i] <span class="ot">&lt;-</span> (b[i] <span class="sc">-</span> <span class="fu">sum</span>(A[i,]<span class="sc">*</span>x) <span class="sc">+</span> A[i,i]<span class="sc">*</span>x[i])<span class="sc">/</span>A[i,i] <span class="co"># součet vek. součinu na 1 řádek</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(x)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(x)</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="jacobiho-metoda-bez-vektorizace" class="level4">
<h4 class="anchored" data-anchor-id="jacobiho-metoda-bez-vektorizace">Jacobiho metoda (bez vektorizace)</h4>
<p><img src="images/clipboard-3400082724.png" class="img-fluid" width="344"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>jacobi <span class="ot">&lt;-</span> <span class="cf">function</span>(A,b){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(b); x0 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n); x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){ <span class="co">#pocet iteraci, staci 10 (méně efektivní - nevyužívá již spočítané iterace,explicitní smyčky zpomalují výpočet)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> (b[i]<span class="sc">-</span> <span class="fu">sum</span>(A[i,]<span class="sc">*</span>x0)<span class="sc">+</span>A[i,i]<span class="sc">*</span>x0[i]) <span class="sc">/</span>A[i,i]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#nepoužívá aktuální hodnoty z právě probíhající iterace – všechny výpočty v jedné iteraci vycházejí pouze z hodnot z předchozí iterace.</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">=</span> x <span class="co">#vypočítá novou aproximaci do x a přiřadí do x0</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="třídiagonální-matice-lu-dekompozice" class="level4">
<h4 class="anchored" data-anchor-id="třídiagonální-matice-lu-dekompozice">Třídiagonální matice (LU dekompozice)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tri_diagonalni_matice <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,c,d){</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(d)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> a </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> d <span class="co">#Dopředná substituce Ly=d</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){ <span class="co">#Řešení pomocí dekompozice na LU a pomocí předního a zpětného substitučního kroku</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    coef <span class="ot">&lt;-</span> <span class="sc">-</span>b[i<span class="dv">-1</span>]<span class="sc">/</span>u[i<span class="dv">-1</span>]<span class="co">#coef se použ. k akt. diag. prvků u[i] a y[i]</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    u[i] <span class="ot">&lt;-</span> a[i]<span class="sc">+</span>coef<span class="sc">*</span>c[i<span class="dv">-1</span>] <span class="co">#aby se vytvořila hor. troju. matice</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> d[i]<span class="sc">+</span>coef<span class="sc">*</span>y[i<span class="dv">-1</span>] </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="co">#numeric(n) </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  x[n] <span class="ot">&lt;-</span> y[n]<span class="sc">/</span>u[n] <span class="co">#Zpětná substituce Ux=y</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) { <span class="co">#postupuje se od posledního prvku x[n]</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> (y[i]<span class="sc">-</span>c[i]<span class="sc">*</span>x[i<span class="sc">+</span><span class="dv">1</span>])<span class="sc">/</span>u[i]  </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>n),<span class="at">nrow=</span>n); b <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="co">#matice a vektor naplním random čísly s hodnotami mezi -1 a 1 podle délky n</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(A) <span class="ot">&lt;-</span> <span class="fu">diag</span>(A)<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>n <span class="co">#Diagonální prvky jsou násobeny 10*n,aby byla matice diagonálně dominantní(nutná podmínka konvergence Gauss-Seidelovy metody)</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A,b); <span class="fu">print</span>(<span class="fu">gaussseidel2</span>(A,b)); <span class="fu">print</span>(<span class="fu">jacobi</span>(A,b)) <span class="co"># řešení aproximace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.003807707 -0.009414512 -0.003743561 -0.009243725 -0.016071647
 [6] -0.004293074  0.005460860  0.012431492 -0.009936577 -0.008566560</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.003807707 -0.009414512 -0.003743561 -0.009243725 -0.016071647
 [6] -0.004293074  0.005460860  0.012431492 -0.009936577 -0.008566560</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.003807707 -0.009414512 -0.003743561 -0.009243725 -0.016071647
 [6] -0.004293074  0.005460860  0.012431492 -0.009936577 -0.008566560</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a-hlavní prvky diagonály,b-prvky poddiag.,c-prvky naddiag.,d-vektor pravé strany rovnice</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; a <span class="ot">&lt;-</span> <span class="fu">runif</span>(n); b <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="dv">-1</span>); c <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="dv">-1</span>); d <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  <span class="co">#naplním random čísly</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tri_diagonalni_matice</span>(a,b,c,d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -1.9706733  1.3285031  0.3108354 -1.1370372  2.1900115 -5.2343628
 [7]  2.8230646 -1.2500030  0.8345394  2.0946695</code></pre>
</div>
</div>
</section>
</section>
<section id="interpolace" class="level3">
<h3 class="anchored" data-anchor-id="interpolace">Interpolace</h3>
<section id="lagrangeova-interpolace" class="level4">
<h4 class="anchored" data-anchor-id="lagrangeova-interpolace">Lagrangeova interpolace</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Lagrange <span class="ot">&lt;-</span> <span class="cf">function</span>(t,x,y){ <span class="co">#počítáme bod t, kde chceme spočítat intepolaci, x jsou body dané na ose x, y jsou uzly na ose y (vektor) </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); suma <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    nasobic <span class="ot">&lt;-</span> <span class="dv">1</span><span class="co">#jsou použity jako váhy pro příslušné základní polynomy</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(j<span class="sc">!=</span>i){ <span class="co">#pro j!= 0</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        nasobic <span class="ot">&lt;-</span> nasobic<span class="sc">*</span>(t<span class="sc">-</span>x[j])<span class="sc">/</span>(x[i]<span class="sc">-</span>x[j]) <span class="co">#Lagrangeův základní polynom Li(t), která se skládá z násobků (t-xj)/(xi-xj), kde j se nerovná i. </span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    suma <span class="ot">&lt;-</span> suma<span class="sc">+</span>y[i]<span class="sc">*</span>nasobic <span class="co">#suma hodnot všech základních polynomů násobených odpovídající hodnotou y[i]</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(suma) <span class="co">#hodnota interpolovaneho polynomu v bodech t stupně n-1</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vandermondova-interpolace-výpočet-koeficientů-polynomu" class="level4">
<h4 class="anchored" data-anchor-id="vandermondova-interpolace-výpočet-koeficientů-polynomu">Vandermondova interpolace (výpočet koeficientů polynomu)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Vandermonde <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span>n,<span class="at">ncol=</span>n)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){ <span class="co">#pro kaž. bod(xi,yi) platí že hodnota P(xi) se musí=yi</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    A[,j] <span class="ot">&lt;-</span> A[,j<span class="dv">-1</span>]<span class="sc">*</span>x <span class="co">#to vede k lin. soustavě rovnic a*c=y</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#c - vektor koeficientú, y - vektor hodnot</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">solve</span>(A,y)) <span class="co">#vektor c koeficientů interp. polynomu stupně n-1</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hornerovo-schéma-vyhodnocení-polynomu" class="level4">
<h4 class="anchored" data-anchor-id="hornerovo-schéma-vyhodnocení-polynomu">Hornerovo schéma (vyhodnocení polynomu)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pol. je obecně vyjádř. ve tvaru: P(x)=anx^n+an-1x^n-1+…+a1x+a0</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(x,coef){ <span class="co">#vyhodnocení polynomu pomocí tvaru funkce: P(x)=(…((anx+an-1)x+an-2)*x+…+a1)x+a0, kde tento přístup minimalizuje počet násobení a sčítání (operací) při výpočtu hodnoty polynomu</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n] <span class="co">#Výpočet začíná od nejvyššího koef.</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) { <span class="co">#pro každý koef. od an-1 po a0 akt. res=res*x+ai</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res<span class="sc">*</span>x<span class="sc">+</span>coef[i] <span class="co">#se postupně přidává k dalším koeficientům tak, že každý mezivýsledek res násobíme x a přičítáme další koef.</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota polynomů pro dané x</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}<span class="co"># vhodné pouze pro hodnocení polynomu</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="newtonova-metoda-výpočet-koeficientů-a-hodnot-newtonova-interpolovaného-polynomu-v-bodech" class="level4">
<h4 class="anchored" data-anchor-id="newtonova-metoda-výpočet-koeficientů-a-hodnot-newtonova-interpolovaného-polynomu-v-bodech">Newtonova metoda (výpočet koeficientů a hodnot newtonova interpolovaného polynomu v bodech)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>NewtonPolCoef <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){ <span class="co">#vektor bodů na ose x a y(mnoziny bodů)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); coef <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co">#vytvoření prázdného vektoru</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  coef[<span class="dv">1</span>] <span class="ot">&lt;-</span> y[<span class="dv">1</span>] <span class="co">#první coef c1 a y1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>){ </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>      suma <span class="ot">&lt;-</span> coef[<span class="dv">1</span>]; nasobic <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>)){</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        nasobic <span class="ot">&lt;-</span> nasobic<span class="sc">*</span>(x[i]<span class="sc">-</span>x[j])</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        suma <span class="ot">&lt;-</span> suma <span class="sc">+</span> coef[j]<span class="sc">*</span>nasobic</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>      } <span class="co">#metoda dělených rozdílů, koeficienty c[i] jsou počítány iterativně pomocí dělených rozdílů a předchozích výsledků.</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>      coef[i] <span class="ot">&lt;-</span> (y[i]<span class="sc">-</span>suma)<span class="sc">/</span>nasobic</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    } <span class="co">#c jsou koef. získané pomocí dělených rozdílů</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(coef) <span class="co">#Vektor koeficientů Newtnova polynomu</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">#pol. P(t)=c1+c2(t-x1)+c3(t-x1)(t-x2)+...+cn-1(t-x1)(t-x2)...(t-xn-1)</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>NewtonPolValue <span class="ot">&lt;-</span> <span class="cf">function</span>(t,x,coef){<span class="co">#t-bod,kde hodnotíme polynom.x: uzly na ose x, coef: koeficienty pol. vypoc. funkcí NewtonPolCoef.</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n] <span class="co">#Začíná od posledního koeficientu cn</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res<span class="sc">*</span>(t<span class="sc">-</span>x[i])<span class="sc">+</span>coef[i]<span class="co">#Newtonův polynom je vyjádřen v rekurzivním tvaru s využitím základních polynomů P(t)</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota polynomu v bodech t P(t)</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; a <span class="ot">&lt;-</span> <span class="dv">0</span>; b <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>pi; x <span class="ot">&lt;-</span> <span class="fu">seq</span>(a,b,<span class="at">length.out=</span>n) <span class="co">#interval od a do b</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n); y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x)<span class="co">#vytvoření y intervalu s náhodnými čísly a přidání sinusových hodnot</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">col=</span><span class="st">"red"</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#vykreslení bodů</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(a,b,<span class="at">by=</span><span class="fl">0.01</span>) <span class="co">#celá čára</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, <span class="fu">Lagrange</span>(t,x,y),<span class="at">col=</span><span class="st">"blue"</span>) <span class="co">#interpolace</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,<span class="fu">Horner</span>(t, <span class="fu">Vandermonde</span>(x,y)),<span class="at">col=</span><span class="st">"green"</span>) </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,<span class="fu">NewtonPolValue</span>(t,x,<span class="fu">NewtonPolCoef</span>(x,y)),<span class="at">col=</span><span class="st">"orange"</span>) <span class="co">#horizontální čáry v bodech</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print(Vandermonde(x,y)) #koeficienty polynomu získané pomocí Vandermondovy metody</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="newtonova-interpolace-stejné-jako-předchozí" class="level4">
<h4 class="anchored" data-anchor-id="newtonova-interpolace-stejné-jako-předchozí">Newtonova interpolace (stejné jako předchozí)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>AddNewtonCoef <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, a){ <span class="co">#výpočet koeficientu pro newtonovu interpolaci x(body na ose x),y(hodnota funkce v odpovídajích bodech x),a(dosavadní koeficienty Newtonova polynomu)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); scitani <span class="ot">&lt;-</span> <span class="dv">0</span>; nasobeni <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#n&lt;-lenghth(x) znázorňuje počet bodů. Funkce scitani akumuluje hodnotu koeficientů při výpočtu.Funkce násobení odpovídá součinu (xn-x1)(xn-x2)…(xn-xi-l) </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    scitani <span class="ot">&lt;-</span> scitani <span class="sc">+</span> a[i]<span class="sc">*</span>nasobeni</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    nasobeni <span class="ot">&lt;-</span> nasobeni<span class="sc">*</span>(x[n]<span class="sc">-</span>x[i]) <span class="co">#smyčka od i=1 do n-1 akumuluje hodnotu koeficientů </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((y<span class="sc">-</span>scitani)<span class="sc">/</span>nasobeni) <span class="co">#koeficient se vypočítá jako podíl rozdílu y-scitani a aktuálního násobení</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>NewtonPolynomial <span class="ot">&lt;-</span> <span class="cf">function</span>(z, a, x){<span class="co">#z(bod, kde se polynom vyhodnocuje),a(koeficienty polynomu),x(body na nichž je polynom založen)</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(a); res <span class="ot">&lt;-</span> a[n] <span class="co">#funkce: res &lt;- a[n]: výpočet začíná od posledního koeficientu</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) res <span class="ot">&lt;-</span> res<span class="sc">*</span>(z <span class="sc">-</span> x[i]) <span class="sc">+</span> a[i] <span class="co">#Smyčka prochází zpětné koeficienty a postupně přidává jejich příspěvek do výsledeku</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lagrangeova-interpolace-1" class="level4">
<h4 class="anchored" data-anchor-id="lagrangeova-interpolace-1">Lagrangeova interpolace</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#výpočet jednotlivých zákl. polynomů Lj(x) pro Lagrangeovu interpolaci</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="cf">function</span>(xa, x, j){ <span class="co">#xa(bod, kde se polynom lj(x) vyhodnocuje),x(vektor uzlů x), j(index bodu, pro který se počítá základní polynom)</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#Lj(x) je 1 v bodě xj a 0 v ostatních bodech</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){ <span class="co">#smyčka iteruje přes všechny body xi kromě bodu xj, pro každý součin i!=j se počítá (xa-x[i])/(x[j]-x[i])</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">!=</span> j) res <span class="ot">&lt;-</span> res<span class="sc">*</span>(xa<span class="sc">-</span>x[i])<span class="sc">/</span>(x[j]<span class="sc">-</span>x[i])</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota zákl. polynomu Lj(xa)</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Lagrangeova interpolace,vyjadř. se jako lin. kombinace základních polynomů Lj(x)</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>Lagrange <span class="ot">&lt;-</span> <span class="cf">function</span>(xa, x, y){ <span class="co">#xa(bod,kde se polynom vyhodnocuje),x (vektor uzlů x), y(vektor hodnot úzlů y) </span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Smyčka iteruje přes všechny uzly a pro každý uzel se vyp. příspěvek yi*Lj(xa), výsledky se sčítají aby vzn. hodn. polynomu v bodě xa</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) res <span class="ot">&lt;-</span> res<span class="sc">+</span>y[i]<span class="sc">*</span><span class="fu">l</span>(xa, x, i) </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota interpolovaného polynomu P(xa)</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n; y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x); <span class="fu">plot</span>(x, y)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> y[<span class="dv">1</span>]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) a[i] <span class="ot">&lt;-</span> <span class="fu">AddNewtonCoef</span>(x[<span class="dv">1</span><span class="sc">:</span>i], y[i], a) <span class="co">#vypočet koeficientů pro další bod</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(x[<span class="dv">1</span>], x[n], <span class="fl">0.01</span>) <span class="co">#generuje mřížka hodnot x.</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Pro každý počet bodů se vykreslí odpovídající interpolace Newtonovým polynomem pomocí funkce lines</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) <span class="fu">lines</span>(z, <span class="fu">NewtonPolynomial</span>(z, a[<span class="dv">1</span><span class="sc">:</span>i], x[<span class="dv">1</span><span class="sc">:</span>i]), <span class="at">col=</span>i<span class="sc">+</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z, <span class="fu">Lagrange</span>(z, x, y)) <span class="co">#interpolace pro všechny body pomocí lines.</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z, y[<span class="dv">8</span>]<span class="sc">*</span><span class="fu">l</span>(z, x, <span class="dv">8</span>), <span class="at">col=</span><span class="st">'red'</span>) <span class="co">#červenou křivku odpovídajcí příspěvku osmého bodu</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">'blue'</span>) <span class="co">#vodorovnou modrou čáru y=0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="aproximace" class="level3">
<h3 class="anchored" data-anchor-id="aproximace">Aproximace</h3>
<section id="kvadratická-aproximace" class="level4">
<h4 class="anchored" data-anchor-id="kvadratická-aproximace">Kvadratická aproximace</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#aproximace funkcí pomocí metody nejmenších čtverců </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coef Vypočítá koeficienty a0,a1,a2 pro aproximaci funkce metodou nejmenších čtverců </span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, phi){<span class="co">#phi-definuje kvadratické bázové funkce konstatní, lineránáí a kvadaratický člen</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># phi je funkce pro polynom 2. stupně k aproximaci</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x, phi) <span class="co">#vandermondova matice</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> M <span class="sc">%*%</span> <span class="fu">t</span>(M) <span class="co">#tranpozice matice M</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">c</span>(M <span class="sc">%*%</span> y) <span class="co">#výpočet vektorů hodnot</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">solve</span>(A,b)) <span class="co">#vyřešení normálních rovnic</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>} <span class="co">#Používá maticový přístup a řešení soustavy normálních rovnic, což umožňuje aproximovat i data, která nejsou přesně polynomiální.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="fu">return</span>(<span class="fu">c</span>(<span class="dv">1</span>,x,x<span class="sc">*</span>x)) }<span class="co"># a0+a1*x+a2*x^2 (Funkce phi pro polynom 2. stupně: [1, x, x^2])</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>phi2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">sin</span>(x),<span class="fu">sin</span>(<span class="dv">16</span><span class="sc">*</span>x))) } <span class="co">#definuje bázové funkce jako sinusové členy s různými frekvencemi</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Příklad 1: Aproximace sin(x) pomocí polynomu 2. stupně</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="fl">0.1</span>); y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y) <span class="co">#zobrazí původní data (sin(x)) jako body. </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Výpočet koeficientů</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">coef</span>(x,y,phi)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="fl">0.001</span>) <span class="co">#vyhodnocení polynomu v bodech xs</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xs, a <span class="sc">%*%</span> <span class="fu">sapply</span>(xs,phi),<span class="at">col=</span><span class="st">"red"</span>) <span class="co">#přídá aproximovanou křivku</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aproximace na jemnější mřížce</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="fl">0.01</span>); y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x)<span class="sc">+</span><span class="fl">0.2</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">16</span><span class="sc">*</span>x)<span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">32</span><span class="sc">*</span>x) <span class="co">#obosahuje kombinaci sinusových funkcí se šumem</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">coef</span>(x,y,phi2) <span class="co">#obsahuje koeficienty odpovídající bázovým funkcím</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="fl">0.0001</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xs, a <span class="sc">%*%</span> <span class="fu">sapply</span>(xs,phi2),<span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="fl">0.01</span>);</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(x<span class="sc">*</span>x<span class="fl">-0.2</span><span class="sc">*</span>x<span class="fl">+0.01</span>)<span class="sc">+</span><span class="fl">0.01</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">100</span><span class="sc">*</span>x)<span class="co">#obsahuje hodnoty racionální funkce s přidaným šumem 1/y: invertuje funkci k usnadnění aproximace</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">coef</span>(x,y,phi)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xs, a <span class="sc">%*%</span> <span class="fu">sapply</span>(xs,phi),<span class="at">col=</span><span class="st">"red"</span>)<span class="co">#invertuje funkci kvůli usnadnění aproximace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lsa-least-square-approximation" class="level4">
<h4 class="anchored" data-anchor-id="lsa-least-square-approximation">LSA (least square approximation)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LSA(implementuje metodu nejmenších čtverců pro nalezení koeficientů aproximačního polynomu, pro body (x,y) vyp. nejlepší možný aproximační polynom stupně n-1, kt. minimalizuje odchyylky mezi hodn. x a predik.h.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>LSA <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, n){ <span class="co">#x a y jevektor hodnot, n je stupeň polynomu</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n); b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co">#vytvoření matice A a vektoru b</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>      <span class="co">#A je matice součtů mocnin x</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      A[i,j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(x<span class="sc">^</span>{i<span class="sc">+</span>j<span class="dv">-2</span>}) </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    }<span class="co">#b je vektor součtů součinů yx^i-1</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    b[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y<span class="sc">*</span>x<span class="sc">^</span>{i<span class="dv">-1</span>}) <span class="co"># součty součinů y*x^(i-1)</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#vyřeší se lin. soustava rovnic LS: A*c=b což</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">solve</span>(A, b)) <span class="co"># vrátí vektor koeficientů c (aprox. polynomu)</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>LSAef <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, n){ <span class="co">#alternativní funkce k LSA s využitím matice mocnin nebo maticových operací (může využívat Vandermondovu matici)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow=</span>n, <span class="at">ncol=</span><span class="fu">length</span>(x)) <span class="co">#matice X, kde každý řádek odopovídá mocnině x nad k-1. Normální rovnice je (X * X nad T) * c=X*y </span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) X[i, ] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, ]<span class="sc">*</span>x <span class="co"># Generování mocnin x </span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">solve</span>(X<span class="sc">%*%</span><span class="fu">t</span>(X), X<span class="sc">%*%</span>y))) <span class="co">#koeficienty aproximačního polynomu</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a){ <span class="co">#mějme třeba polynom pro a:2x^3-6x^2+2x-1</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#výpočet hodnoty v bodě x, a je vektor koeficientů an, an-1,...,a0</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(a); res <span class="ot">&lt;-</span> a[n] <span class="co"># Začíná od posledního koeficientu</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>){<span class="co">#Algoritmus umožňuje minimalizovat počet operací proti běžnému vyhodnocování polynomu</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res <span class="sc">*</span> x <span class="sc">+</span> a[i] <span class="co">#proch koef. iterací po zpátku</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota polynomu P(x) v bodě x</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>; x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="co">#100 náhodných bodů v intervalu od -1 do 1</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(x) <span class="co"># funkční hodnoty </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fu">LSA</span>(x, y, m) <span class="co"># výpočet koeficientů pomocí LSA</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print(coef); coef &lt;- LSAef(x, y, m) # alternativní výpočet koeficientů</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#print(coef) #vektor koeficientů</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="fu">Horner</span>(x, coef), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lw =</span> <span class="dv">2</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="co">#udělá čáru přes koeficienty</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="aproximace-exponenciální-funkce-taylorovou-řadou" class="level4">
<h4 class="anchored" data-anchor-id="aproximace-exponenciální-funkce-taylorovou-řadou">Aproximace exponenciální funkce Taylorovou řadou</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ExpTaylor <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">n=</span><span class="dv">1</span>){<span class="co">#aproximace funkce e^x pomocí n-členů Taylorovy řady</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  term <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(x)); res <span class="ot">&lt;-</span> term <span class="co">#začínají hodnotou 1</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){ </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>      <span class="co">#přidávají se jednotlivé členy Taylorovy řady x na k /k faktoriál </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>      term <span class="ot">&lt;-</span> term<span class="sc">*</span>x<span class="sc">/</span>(i<span class="dv">-1</span>)<span class="co">#uchovává aktuální člen Taylorovy řady</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">&lt;-</span> res <span class="sc">+</span> term <span class="co">#uchovává součet všech členů.</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#vrátí přibližnou hodnotu e^x pro každý bod x</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>} <span class="co">#funguje pro různé funkce v různých bodech a</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span>; b <span class="ot">&lt;-</span> <span class="dv">3</span>; x <span class="ot">&lt;-</span> <span class="fu">seq</span>(a,b,<span class="fl">0.001</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(exp, <span class="at">xlim=</span><span class="fu">c</span>(a,b),<span class="at">lwd=</span><span class="dv">4</span>) <span class="co">#exponenciální funkci e na x</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># přidává aproximace pro n=1 až n=8 pomocí různých barev</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){ <span class="fu">lines</span>(x,<span class="fu">ExpTaylor</span>(x,i),<span class="at">col=</span><span class="fu">colors</span>()[i<span class="sc">+</span><span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>) } <span class="co"># ExpTaylor je použita k vykreslení aproximace e na x pro různé stupně n </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="numerické-derivace-integrace" class="level3">
<h3 class="anchored" data-anchor-id="numerické-derivace-integrace">Numerické derivace, integrace</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>PrvniDerA <span class="ot">&lt;-</span> <span class="cf">function</span>(f,x, h){<span class="fu">return</span>((<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="fu">f</span>(x))<span class="sc">/</span>h)}<span class="co">#první derivace (jednostranná), dopředná diference k aproximaci první derivace</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>PrvniDerB <span class="ot">&lt;-</span> <span class="cf">function</span>(f,x, h){<span class="fu">return</span>((<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="fu">f</span>(x<span class="sc">-</span>h))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>h))}<span class="co">#první derivace (centrální difference), k aproximaci první derivace (přesnější než dopředná) </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>DruhaDerB <span class="ot">&lt;-</span> <span class="cf">function</span>(f,x, h){<span class="fu">return</span>((<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">f</span>(x)<span class="sc">-</span><span class="fu">f</span>(x<span class="sc">-</span>h))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>h))}<span class="co">#druhá derivace (pomocí centrální difference)</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">#vrací nám přibližnou hodnotu nějaký funkce nějakým bodě x s krokem h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="midpoint-rule-num.-derivace" class="level4">
<h4 class="anchored" data-anchor-id="midpoint-rule-num.-derivace">Midpoint Rule (num. derivace)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Midpoint Rule (num. derivace, numerická metoda aproximace integrálu pomocí metody středního bodu)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>MidPointRule <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b,<span class="at">n=</span><span class="dv">1</span>){<span class="co">#n - počet podintervalů</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b<span class="sc">-</span>a)<span class="sc">/</span>n <span class="co">#délka každého subintervalu je h= b-a/n, Funkční hodnoty jsou počítány ve středech subintervalů</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Plocha pod křivkou v každém podintervalu je aproximována pomocí obdélníku o základně h a výšce f. </span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(h<span class="sc">*</span><span class="fu">sum</span>(<span class="fu">f</span>(h<span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span>n)<span class="sc">+</span>a<span class="sc">-</span>h<span class="sc">*</span><span class="fl">0.5</span>)))<span class="co">#aproximovaná hodnota integrálu</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">0</span>; b <span class="ot">&lt;-</span> pi; <span class="fu">print</span>(<span class="fu">cos</span>(a)<span class="sc">-</span><span class="fu">cos</span>(b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:30) cat(i,'\n', MidPointRule(sin,a,b,2^i),'\n') #vypíše iterace (přibližně 2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simpsons-rule-num.-derivace" class="level4">
<h4 class="anchored" data-anchor-id="simpsons-rule-num.-derivace">Simpson’s rule (num. derivace)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>SimpsonRule <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b,<span class="at">n=</span><span class="dv">1</span>){ </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Kombinuje funkční hodnoty na krajních bodech,koeficienty 4x hodnoty ve stř bodech a 2x hodnoty mezi středy</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b<span class="sc">-</span>a)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n) <span class="co">#velikost subintervalu se sudým počtem(n)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  hpul <span class="ot">&lt;-</span> h<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  suma <span class="ot">&lt;-</span> <span class="fu">f</span>(a)<span class="sc">+</span><span class="fu">f</span>(b) <span class="co">#funkční hodnoty na krajních bodech</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> a<span class="sc">+</span>h<span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span>n) <span class="sc">+</span> a <span class="sc">-</span> hpul</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  suma <span class="ot">&lt;-</span> suma <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">sum</span>(<span class="fu">f</span>(xs))<span class="co"># liché hodnoty</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    xl <span class="ot">&lt;-</span> (xs <span class="sc">+</span> hpul)[<span class="sc">-</span>n]</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    suma <span class="ot">&lt;-</span> suma <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(<span class="fu">f</span>(xs)) <span class="co">#sudé hodnoty</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(suma<span class="sc">*</span>h<span class="sc">/</span><span class="dv">6</span>) <span class="co">#vynásobim konstantou h/6 pro normalizaci approx.</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:30) cat(i,'\n',SimpsonRule(sin,a,b,2^i),'\n')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="metody-pro-řešení-diferenciálních-rovnic-druhého-řádu-s-aproximací" class="level3">
<h3 class="anchored" data-anchor-id="metody-pro-řešení-diferenciálních-rovnic-druhého-řádu-s-aproximací">Metody pro řešení diferenciálních rovnic druhého řádu (s aproximací)</h3>
<section id="eulerova-metoda" class="level4">
<h4 class="anchored" data-anchor-id="eulerova-metoda">Eulerova metoda</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eulerova metoda (přidá hodnotu derivace (určené funkcí f) k aktuálnímu vztahu), k aproximace řešení dif. rovnice 1. řádu</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>euler <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,f,h){<span class="fu">return</span>(y<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(x,y))} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="runge-kutta-aproximaxe-derivací" class="level4">
<h4 class="anchored" data-anchor-id="runge-kutta-aproximaxe-derivací">Runge kutta (aproximaxe derivací)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>RK <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,f,h){ hhalf <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>h; <span class="fu">return</span>(x<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(x<span class="sc">+</span>hhalf,y<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(x<span class="sc">+</span>hhalf,y<span class="sc">+</span>hhalf<span class="sc">*</span><span class="fu">f</span>(x,y)))) } <span class="co">#ve skutečnosti jde o eulerovu metodu</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>RK2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y , f, h){ <span class="co">#runge kutta 2. řádu, používá jeden mezikrok k lepší aproximaci derivace</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  hhalf <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>h</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(x<span class="sc">+</span>hhalf,y<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(x<span class="sc">+</span>hhalf,y<span class="sc">+</span>hhalf<span class="sc">*</span><span class="fu">f</span>(x,y))))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>RK4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,f,h){ <span class="co">#4 mezikroky k dosažení vyšší přesnosti, má velmi malou chybu i při větších krocích. Bere totiž v úvahu. derivace na začátku, uprostřed a na konci intervalu.</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  hhalf <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>h</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  k1 <span class="ot">&lt;-</span> <span class="fu">f</span>(x,y)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  k2 <span class="ot">&lt;-</span> <span class="fu">f</span>(x<span class="sc">+</span>hhalf,y<span class="sc">+</span>hhalf<span class="sc">*</span>k1)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  k3 <span class="ot">&lt;-</span> <span class="fu">f</span>(x<span class="sc">+</span>hhalf,y<span class="sc">+</span>hhalf<span class="sc">*</span>k2)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  k4 <span class="ot">&lt;-</span> <span class="fu">f</span>(x<span class="sc">+</span>h,y<span class="sc">+</span>h<span class="sc">*</span>k3)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (y<span class="sc">+</span>((h<span class="sc">/</span><span class="dv">6</span>)<span class="sc">*</span>(k1<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>(k2<span class="sc">+</span>k3)<span class="sc">+</span>k4)))</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x, y){ <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> x <span class="sc">*</span> y }; x0 <span class="ot">&lt;-</span> <span class="dv">0</span>; y0 <span class="ot">&lt;-</span> <span class="dv">1</span>; h <span class="ot">&lt;-</span> <span class="fl">0.1</span><span class="co">#dif rce. 1. ř.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definice diferenciální rovnice pro oscilátor</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span>  <span class="cf">function</span>(t,X){  <span class="fu">return</span>(<span class="fu">c</span>(X[<span class="dv">2</span>],<span class="sc">-</span>X[<span class="dv">1</span>]<span class="sc">-</span><span class="fl">0.1</span><span class="sc">*</span>X[<span class="dv">2</span>])) }<span class="co">#Rovnice: dx/dt = v, dv/dt = -x - 0.1v, X &lt;- c(x[1],x[2]) &lt;- c(x,v), pravá str. rovnice</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#časový interval[0,100], rozdělen na 1000 kroků s krokovou velikostí h=0.1 </span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>tMAX <span class="ot">&lt;-</span> <span class="dv">100</span>; n <span class="ot">&lt;-</span> <span class="dv">1000</span>; h <span class="ot">&lt;-</span> tMAX<span class="sc">/</span>n; t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,tMAX,h)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n<span class="sc">+</span><span class="dv">1</span>; X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n,<span class="at">ncol=</span><span class="dv">2</span>)<span class="co">#Matice x uchovává hodnoty polohy a rychlosti, začínjící na x(0)=100,v(0)=0</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">100</span>; X[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#rozmezí x</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){ X[i,] <span class="ot">&lt;-</span> <span class="fu">euler</span>(t,X[i<span class="dv">-1</span>,],f,h) } <span class="co"># Výpočet pomocí Eulerovy metody</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t,X[,<span class="dv">1</span>],<span class="at">col=</span><span class="st">'red'</span>,<span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>Xrk2 <span class="ot">&lt;-</span> X</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) Xrk2[i,] <span class="ot">&lt;-</span> <span class="fu">RK2</span>(t, Xrk2[i<span class="dv">-1</span>,], f, h) <span class="co">#RK2</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, Xrk2[,<span class="dv">1</span>], <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>Xrk4 <span class="ot">&lt;-</span> X</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){ Xrk4[i,] <span class="ot">&lt;-</span> <span class="fu">RK4</span>(t,Xrk4[i<span class="dv">-1</span>,],f,h) } <span class="co">#RK4</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,Xrk4[,<span class="dv">1</span>],<span class="at">col=</span><span class="st">'blue'</span>,<span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, <span class="dv">100</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.1</span><span class="sc">*</span>t<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">cos</span>(t), <span class="at">col=</span><span class="st">'green'</span>, <span class="at">type=</span><span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="eulerova-metoda-aproximace-nového-stavu-pomocí-gradientu-v-daném-bodě" class="level4">
<h4 class="anchored" data-anchor-id="eulerova-metoda-aproximace-nového-stavu-pomocí-gradientu-v-daném-bodě">Eulerova metoda (aproximace nového stavu pomocí gradientu v daném bodě)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>EulerStep <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x, y, h){ <span class="fu">return</span>(y<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(x,y)) }</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#(Midpoint Method)Vylepšená metoda Eulerova kroku využívající predikci ve středu intervalu</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>EulerStepIIa <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x, y, h){</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  hpul <span class="ot">&lt;-</span> h<span class="sc">*</span><span class="fl">0.5</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(x<span class="sc">+</span>hpul,<span class="fu">EulerStep</span>(f, x, y, hpul)))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Kombinuje hodnotu derivace na začátku intervalu a na konci intervalu. Zase o něco vyšší přesnost, protože využ. více inf. o průběhu derivace.</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>EulerStepIIb <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x, y, h){</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y<span class="sc">+</span>h<span class="sc">*</span><span class="fl">0.5</span><span class="sc">*</span>(<span class="fu">f</span>(x, y) <span class="sc">+</span> <span class="fu">f</span>(x, <span class="fu">EulerStep</span>(f, x, y, h))))</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>RK4 <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x, y, h){</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  hpul <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>h; k1 <span class="ot">&lt;-</span> <span class="fu">f</span>(x, y); xshift <span class="ot">&lt;-</span> x <span class="sc">+</span> hpul; k2 <span class="ot">&lt;-</span> <span class="fu">f</span>(xshift, y <span class="sc">+</span> hpul<span class="sc">*</span>k1); k3 <span class="ot">&lt;-</span> <span class="fu">f</span>(xshift, y <span class="sc">+</span> hpul<span class="sc">*</span>k2); k4 <span class="ot">&lt;-</span> <span class="fu">f</span>(x<span class="sc">+</span>h, y <span class="sc">+</span> h<span class="sc">*</span>k3)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y<span class="sc">+</span>h<span class="sc">*</span>(k1<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>(k2<span class="sc">+</span>k3)<span class="sc">+</span>k4)<span class="sc">/</span><span class="dv">6</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dvě diferenciální rovnice prvního řádu</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){ <span class="fu">return</span>(<span class="sc">-</span>y) } <span class="co">#expoenciální pokles -y</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>fSchwingung <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){ <span class="fu">return</span>(<span class="fu">c</span>(y[<span class="dv">2</span>], <span class="sc">-</span>y[<span class="dv">1</span>]<span class="sc">-</span><span class="fl">0.1</span><span class="sc">*</span>y[<span class="dv">2</span>])) } <span class="co"># harmonický oscilátor s tlumením</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#pocet kroku, tMax, dt, n0-poc hodnota</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span>; tMax <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>); dt <span class="ot">&lt;-</span> tMax<span class="sc">/</span>N; t <span class="ot">&lt;-</span> dt<span class="sc">*</span>(<span class="dv">0</span><span class="sc">:</span>N) <span class="co">#casova sekvence</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> <span class="dv">300</span>; n <span class="ot">&lt;-</span> t; n[<span class="dv">1</span>] <span class="ot">&lt;-</span> n0</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) n[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">EulerStep</span>(f, t[i], n[i], dt)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(t) n0<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>t), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, tMax), <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lwd=</span><span class="dv">2</span>) <span class="co">#vykreslení funkce</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(t, n, <span class="at">col=</span><span class="st">'blue'</span>) <span class="co">#bodů ve funkci (pro exp pokles)</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">#(všechno skoro stejné)</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>nIIa <span class="ot">&lt;-</span> t; nIIa[<span class="dv">1</span>] <span class="ot">&lt;-</span> n0</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) nIIa[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">EulerStepIIa</span>(f, t[i], nIIa[i], dt)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(t, nIIa, <span class="at">col=</span><span class="st">'green'</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>nIIb <span class="ot">&lt;-</span> t; nIIb[<span class="dv">1</span>] <span class="ot">&lt;-</span> n0</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) nIIb[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">EulerStepIIb</span>(f, t[i], nIIb[i], dt)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(t, nIIb, <span class="at">col=</span><span class="st">'cyan'</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>nRK4 <span class="ot">&lt;-</span> t; nRK4[<span class="dv">1</span>] <span class="ot">&lt;-</span> n0</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) nRK4[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">RK4</span>(f, t[i], nRK4[i], dt)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(t, nRK4, <span class="at">col=</span><span class="st">'violet'</span>) <span class="co">#je to přesně na čáře</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#řešení s tlumenou oscilací se schwingung(n-pocet kroků,t-max.čas,x0-poč. hodnota polohy)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">200</span>; tMax <span class="ot">&lt;-</span> <span class="dv">8</span><span class="sc">*</span>pi; dt <span class="ot">&lt;-</span> tMax<span class="sc">/</span>N; t <span class="ot">&lt;-</span> dt<span class="sc">*</span>(<span class="dv">0</span><span class="sc">:</span>N); x0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>N<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>); x[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> x0; x[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) x[i<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">EulerStep</span>(fSchwingung, t[i], x[i, ], dt)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, x0<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.05</span><span class="sc">*</span>t)<span class="sc">*</span><span class="fu">cos</span>(t), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, tMax), <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">'l'</span>) <span class="co">#vykreslení oscilace</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(t, x[,<span class="dv">1</span>], <span class="at">col=</span><span class="st">'blue'</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co">#postupně se přibližuje</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>xIIa <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>N<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>); xIIa[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> x0; xIIa[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) xIIa[i<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">EulerStepIIa</span>(fSchwingung, t[i], xIIa[i, ], dt)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(t, xIIa[,<span class="dv">1</span>], <span class="at">col=</span><span class="st">'green'</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>xIIb <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>N<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>); xIIb[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> x0; xIIb[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) xIIb[i<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">EulerStepIIb</span>(fSchwingung, t[i], xIIb[i, ], dt)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(t, xIIb[,<span class="dv">1</span>], <span class="at">col=</span><span class="st">'cyan'</span>)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>xRK4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>N<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>); xRK4[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> x0; xRK4[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) xRK4[i<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">RK4</span>(fSchwingung, t[i], xRK4[i, ], dt)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(t, xRK4[,<span class="dv">1</span>], <span class="at">col=</span><span class="st">'violet'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="integrace-a-aproximace-funkce-pomocí-různých-metod" class="level3">
<h3 class="anchored" data-anchor-id="integrace-a-aproximace-funkce-pomocí-různých-metod">Integrace a aproximace funkce pomocí různých metod</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(x,coef){</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#výpočet polynomu zadaného koeficienty a pro danou hodnotu x</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n]</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res<span class="sc">*</span>x<span class="sc">+</span>coef[i]</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#vrací hodnotu polynomu P(x) v bodě x</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">#výpočet hodnoty integrálu polynomu na intervalu (a,b) s použitím hornerova schématu a s přímou úpravou koeficientů pro integrační polynom</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>Anal_integ_pol <span class="ot">&lt;-</span> <span class="cf">function</span>(coef,a,b){</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> coef<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>n) <span class="co">#Koeficienty jsou upraveny vydělením hodnotou 1,2,…,n odpovídající stupni</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b<span class="sc">*</span><span class="fu">Horner</span>(coef,b)<span class="sc">-</span>a<span class="sc">*</span><span class="fu">Horner</span>(coef,a))</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="monte-carlo" class="level4">
<h4 class="anchored" data-anchor-id="monte-carlo">Monte carlo</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Monte Carlo metoda, náhodné vybere n bodů xi z intervalu a,b pomocí runif, vyhodnotí funkčí hodnoty,spočítá jejich průměr a vynásobí délkou integrálu(b-a)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>integ_stredni_hodnota <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b,N){ <span class="fu">return</span> (<span class="fu">mean</span>(<span class="fu">f</span>(<span class="fu">runif</span>(N,a,b)))<span class="sc">*</span>(b<span class="sc">-</span>a)) } <span class="co">#výpočet integrálu</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">integ_stredni_hodnota</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.713132</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Symetrická verze metody střední hodnoty, která přidává symetrickou hodnotu funkce kolem středu intervalu, tím snižuje chybu, že využ. informaci z obou pol. intervalu</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>integ_stredni_hodnota_sym <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b,N){x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,a,b); <span class="fu">return</span> (<span class="fl">0.5</span><span class="sc">*</span><span class="fu">mean</span>(<span class="fu">f</span>(x)<span class="sc">+</span><span class="fu">f</span>(a<span class="sc">+</span>b<span class="sc">-</span>x))<span class="sc">*</span>(b<span class="sc">-</span>a)) }</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Geometrická metoda Monte Carlo,která náhodně generuje body(xi,yi) v obdélníku(a,b) x(0,h) a počítá podíl bodů pod křivkou f(x), kde yi&lt;=f(xi)), přibližuje S plochy pod křivkou jako poměr bodů pod křivkou x obsah obdelníka</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>integ_geom <span class="ot">=</span> <span class="cf">function</span>(f,a,b,h,N){ </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,a,b)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">0</span>,h)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">mean</span>(<span class="fu">f</span>(<span class="fu">runif</span>(N,a,b)))<span class="sc">*</span>(b<span class="sc">-</span>a))</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>} <span class="co">#využívá se například u vícerozměrných integrálů nebo stochastických simulací</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gausova-kvadratura-aproximace-integrálu" class="level4">
<h4 class="anchored" data-anchor-id="gausova-kvadratura-aproximace-integrálu">Gausova kvadratura (aproximace integrálu)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>gauss_g_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b){ <span class="co">#dvoudobá gaussova kvadratura</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">3</span>); x2 <span class="ot">&lt;-</span> <span class="sc">-</span>x1 <span class="co">#používá dvě hodnoty na základě kořenů Lagrangeových polynomů druhého stupně(+-1/odmocnina ze 3),každý bod dostává stejnou váhu x2=x1=1</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(x1,x2) <span class="co">#převádí na reálný interval [a,b]</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  sklon <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>(b<span class="sc">-</span>a)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(<span class="fu">f</span>(x<span class="sc">*</span>sklon<span class="fl">+0.5</span><span class="sc">*</span>(a<span class="sc">+</span>b)))<span class="sc">*</span>sklon) <span class="co">#přesná pro pol. do stupně 3</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>gauss_q_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b){ <span class="co">#tříbodová gaussova kvadratura</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fl">0.6</span>) <span class="co">#na základě kořenů Legenderovýcg polynomů třetího stupně 0 a +-(1/odmocnina z 0,6).</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(x1,<span class="sc">-</span>x1,<span class="dv">0</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  sklon <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>(b<span class="sc">-</span>a)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">f</span>(x<span class="sc">*</span>sklon<span class="fl">+0.5</span><span class="sc">*</span>(a<span class="sc">+</span>b))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">9</span><span class="sc">*</span>(y[<span class="dv">1</span>]<span class="sc">+</span>y[<span class="dv">2</span>])<span class="sc">+</span><span class="dv">8</span><span class="sc">/</span><span class="dv">9</span><span class="sc">*</span>y[<span class="dv">3</span>]<span class="co">#váhové koeficienty (w1=w2=5/9 a w3=8/9) pro hodnoty v bodech</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res<span class="sc">*</span>sklon) <span class="co"># přesná pro polynomy do stupně 5</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#monte carlo (počet integrací N)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>; res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="fu">integ_stredni_hodnota</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>,N))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">mean</span>(res),<span class="st">"+-"</span>, <span class="fu">sd</span>(res)) <span class="co"># průměrný výsledek(mean) + chyba(sd)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.718841 +- 0.01547941</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4000</span>; res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">4000</span>,<span class="fu">integ_stredni_hodnota</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>,N))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">mean</span>(res),<span class="st">"+-"</span>,<span class="fu">sd</span>(res))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.718432 +- 0.007724517</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>; res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="fu">integ_stredni_hodnota_sym</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>,N))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">mean</span>(res),<span class="st">"+-"</span>, <span class="fu">sd</span>(res))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.718317 +- 0.00198816</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4000</span>; res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">4000</span>,<span class="fu">integ_stredni_hodnota_sym</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>,N))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">mean</span>(res),<span class="st">"+-"</span>,<span class="fu">sd</span>(res))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.718268 +- 0.0009791702</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>; res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="fu">integ_geom</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,N))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">mean</span>(res),<span class="st">"+-"</span>, <span class="fu">sd</span>(res))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.717798 +- 0.0156313</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4000</span>; res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="fu">integ_geom</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,N))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">mean</span>(res),<span class="st">"+-"</span>, <span class="fu">sd</span>(res))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.717875 +- 0.007800757</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#testování</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gauss_g_2</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>)); <span class="fu">print</span>(<span class="fu">gauss_q_3</span>(exp,<span class="dv">0</span>,<span class="dv">1</span>)); <span class="fu">print</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>) <span class="co">#exponenciální funkce od 0 do 1 (porovnání přesnosti)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.717896</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.846264</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.718282</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gauss_g_2</span>(<span class="cf">function</span>(x) <span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span><span class="dv">7</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2-5</span><span class="sc">*</span>x<span class="sc">+</span><span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="co"># integrate 2*x^3+7*x^2-5*x+3 from 5 to 6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 523.3333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">15</span>; coef <span class="ot">&lt;-</span> <span class="fu">runif</span>(N); <span class="fu">print</span>(<span class="fu">gauss_q_3</span>(<span class="cf">function</span>(x) <span class="fu">Horner</span>(coef,x),<span class="dv">5</span>,<span class="dv">6</span>)) <span class="co">#integrace polynomu pomocí tříb. gauss k. s náhodnými koeficienty k přibližné integraci pol. v intervalu [5,6], horner vyhodnotí hodnotu polynomu v bodě x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.757592</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anal_integ_pol</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">2</span>),<span class="dv">5</span>,<span class="dv">6</span>) <span class="co">#vypočítá intergál polynomu v intervalu [5,6]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
</div>
</section>
</section>
<section id="integrace-polynomu" class="level3">
<h3 class="anchored" data-anchor-id="integrace-polynomu">Integrace polynomu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(coef, x){ <span class="co">#Hornerovo schéma pro výpočet polynomu Vstupy: coef(koeficienty polynomu),x(bod, ve kterém se polynom vyhodnocuje)</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n]</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>){res <span class="ot">&lt;-</span> res<span class="sc">*</span>x<span class="sc">+</span>coef[i]}</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">#integrace polynomu v intervalu (a,b), Coef(koeficienty polynomu), pomocí primitivní funkce</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>IntegratePolynom <span class="ot">&lt;-</span> <span class="cf">function</span>(coef, a, b){ </span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> coef<span class="sc">/</span><span class="dv">1</span><span class="sc">:</span>n <span class="co">#najdeme primitivní funkci polynomu, coef se počítá pomocí Horner schématu</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(a, b)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> coef[n]</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>){res <span class="ot">&lt;-</span> res<span class="sc">*</span>x<span class="sc">+</span>coef[i]}</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> res<span class="sc">*</span>x</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res[<span class="dv">2</span>]<span class="sc">-</span>res[<span class="dv">1</span>]) <span class="co">#hodnota integrálu polynomu, výpočet rozdílu I=F(b)-F(a)</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Monte carlo um integ. pomocí geom. metody (f(funkce k integraci),body a,b(meze intervalu),h(horní hranice-maximální hodnota funkce),n(počet náhodných bodů) )</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>GeomMethod <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, h, n){ </span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, a, b) <span class="co">#Generují se náhodné body a porovnává se, zda leží pod grafem funkce. Poměr bodů pod grafem k celkovému počtu bodů odhaduje integrál</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, h)</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(h<span class="sc">*</span>(b<span class="sc">-</span>a)<span class="sc">*</span><span class="fu">sum</span>(y <span class="sc">&lt;</span> <span class="fu">f</span>(x))<span class="sc">/</span>n)</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="co">#num. integ. Monte Carlo pomocí průměru hodnot, f(funkce k integraci), body a,b(meze intervalu), n(počet náhodných bodů)</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>AveMethod <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, n){<span class="fu">return</span>((b<span class="sc">-</span>a)<span class="sc">*</span><span class="fu">mean</span>(<span class="fu">f</span>(<span class="fu">runif</span>(n, a, b))))} <span class="co"># Generují se náhodné body a počítá se průměr hodnot funkce v těchto bodech. Tento průměr se násobí délkou intervalu</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Gaussova kvadratura druhého, třetího a čtvrtého řádu</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>Gauss2 <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b){</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">3</span>) <span class="co">#Hodnoty a váhy Gaussovy kvadratury se předem nastaví. Integrál se vypočítá jako vážený součet hodnot funkce v určených bodech</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (b<span class="sc">-</span>a)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> (a<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(slope<span class="sc">*</span><span class="fu">sum</span>(<span class="fu">f</span>(slope<span class="sc">*</span><span class="fu">c</span>(x, <span class="sc">-</span>x)<span class="sc">+</span>intercept)))</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>Gauss3 <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b){</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">0.6</span>)</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>x, <span class="dv">0</span>, x)</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">5</span>)<span class="sc">/</span><span class="dv">9</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (b<span class="sc">-</span>a)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> (a<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(slope<span class="sc">*</span><span class="fu">sum</span>(w<span class="sc">*</span><span class="fu">f</span>(slope<span class="sc">*</span>x<span class="sc">+</span>intercept)))</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>Gauss4 <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b){ </span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#implementuje gauss k. na 4 body na intervalu [a,b],což znamená že přesně integruje polynomy až 7.stupně</span></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">7</span><span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span><span class="dv">7</span>) <span class="co">#uzly které jsou kořeny L. polynomu P4(x)</span></span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">7</span><span class="sc">+</span><span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span><span class="dv">7</span>)</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(x1, <span class="sc">-</span>x1, x2, <span class="sc">-</span>x2) <span class="co">#čísla se uloží do vektoru</span></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>  w1 <span class="ot">&lt;-</span> (<span class="dv">18</span><span class="sc">+</span><span class="fu">sqrt</span>(<span class="dv">30</span>))<span class="sc">/</span><span class="dv">36</span> <span class="co">#odpovídající váhy w1 a w2</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>  w2 <span class="ot">&lt;-</span> (<span class="dv">18</span><span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">30</span>))<span class="sc">/</span><span class="dv">36</span></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">c</span>(w1, w1, w2, w2) <span class="co">#do vektoru jsou váhy přizařeny odpovídajícím uzlům</span></span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (b<span class="sc">-</span>a)<span class="sc">/</span><span class="dv">2</span> <span class="co">#transformace integrálu, měřítko integrálu</span></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> (a<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span> <span class="co">#posunutí ke středu intervalu</span></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(slope<span class="sc">*</span><span class="fu">sum</span>(w<span class="sc">*</span><span class="fu">f</span>(slope<span class="sc">*</span>x<span class="sc">+</span>intercept))) <span class="co">#spočítá se součet funkčních hodnot</span></span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>} <span class="co">#vrátí se numerická aproximace integrálu</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>; b <span class="ot">&lt;-</span> <span class="dv">7</span>; coef <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">6</span>) <span class="co">#naplním koeficient náhodnými čísly</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">IntegratePolynom</span>(coef, a, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4580.603</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Gauss2</span>(<span class="cf">function</span>(x) <span class="fu">Horner</span>(coef, x), a , b); <span class="fu">Gauss3</span>(<span class="cf">function</span>(x) <span class="fu">Horner</span>(coef, x), a , b); <span class="fu">Gauss4</span>(<span class="cf">function</span>(x) <span class="fu">Horner</span>(coef, x), a , b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4533.783</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4580.603</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4580.603</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="fu">exp</span>(<span class="dv">0</span>); <span class="fu">Gauss2</span>(exp, <span class="dv">0</span> , <span class="dv">1</span>); <span class="fu">Gauss3</span>(exp, <span class="dv">0</span> , <span class="dv">1</span>); <span class="fu">Gauss4</span>(exp, <span class="dv">0</span> , <span class="dv">1</span>) <span class="co">#výpočet exponenciální funkce</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.718282</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.717896</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.718281</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.718282</code></pre>
</div>
</div>
</section>
<section id="hledání-kořenu-funkce-rovnice" class="level3">
<h3 class="anchored" data-anchor-id="hledání-kořenu-funkce-rovnice">Hledání kořenu funkce (rovnice)</h3>
<section id="newtonovy-metody" class="level4">
<h4 class="anchored" data-anchor-id="newtonovy-metody">Newtonovy metody</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new. metoda, iterativně hledá kořen funkce tj.hodnotu x^* pro kt. platí f(x^*)=0 pomocí vztahu taylorovy aproximace funkce: xn+1=xn-f(xn)/f’(xn) </span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>NewtonRoot <span class="ot">&lt;-</span> <span class="cf">function</span>(f,fd,xstart,<span class="at">acc=</span><span class="fl">0.000000001</span>){</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> xstart; citac <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#začneme odhadem x0</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{ citac <span class="ot">&lt;-</span> citac<span class="sc">+</span><span class="dv">1</span> <span class="co">#iterativně vyp. nové odhady pomocí Newtonova vzorce</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> <span class="fu">f</span>(x)<span class="sc">/</span><span class="fu">fd</span>(x) <span class="co">#derivace x</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x<span class="sc">-</span>dx <span class="co">#x &lt;- x-f(x)/fd(x)</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(dx)<span class="sc">&lt;</span>acc){ <span class="co">#končíme pokud je dx&lt;než přesnost acc</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(citac); <span class="co">#výpis počtu interací</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x)} <span class="co">#vrací nalezený kořen</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#metoda se může zacyklit nebo konvergovat pomalu, vhodne pro analytickou der.</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Newtonovy metoda s dopřednou diferencí f’(x), kde h je malá hodnota</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>NewtonRootVarB <span class="ot">&lt;-</span> <span class="cf">function</span>(f,xstart,<span class="at">acc=</span><span class="fl">0.000000001</span>){</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> xstart; h<span class="ot">&lt;-</span>acc; citac <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{ citac <span class="ot">&lt;-</span> citac<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> h<span class="sc">*</span><span class="fu">f</span>(x)<span class="sc">/</span>(<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="fu">f</span>(x)) <span class="co">#získáme upravený vzorec pro Newtonovu iteraci</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x<span class="sc">-</span>dx <span class="co">#x &lt;- x-f(x)/fd(x)</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(dx)<span class="sc">&lt;</span>acc){ <span class="fu">print</span>(citac); <span class="fu">return</span>(x)}</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#může být nepřesná pro malé hodnoty h a má pomalejší konvergenci</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a><span class="co">#varianta s kvadratickou aproximací derivace: dx=F(x)2/f(x+f(x))-f(x)</span></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>NewtonRootVarC <span class="ot">&lt;-</span> <span class="cf">function</span>(f,xstart,<span class="at">acc=</span><span class="fl">0.000000001</span>){</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> xstart; citac <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{ citac <span class="ot">&lt;-</span> citac<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">f</span>(x)</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> y<span class="sc">*</span>y<span class="sc">/</span>(<span class="fu">f</span>(x<span class="sc">+</span>y)<span class="sc">-</span>y)</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x<span class="sc">-</span>dx <span class="co">#x &lt;- x-f(x)/fd(x)</span></span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(dx)<span class="sc">&lt;</span>acc){ <span class="fu">print</span>(citac); <span class="fu">return</span>(x)}</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#funguje lépe když je f(x) těžké spočítat, ale pomalejší konvergence</span></span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Používá drouhou derivaci f’‘(x) k vylepšení iterace pomocí vzorce: </span></span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a><span class="co"># dx=(2f(x)f’(x))/(2(f’(x))^2-f(x)f’’(X))</span></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a>NewtonRootVarD <span class="ot">&lt;-</span> <span class="cf">function</span>(f,fd,fdd,xstart,<span class="at">acc=</span><span class="fl">0.000000001</span>){</span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> xstart; citac <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{ citac <span class="ot">&lt;-</span> citac<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">f</span>(x); yd <span class="ot">&lt;-</span> <span class="fu">fd</span>(x); ydd <span class="ot">&lt;-</span> <span class="fu">fdd</span>(x)</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>  dx <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>y<span class="sc">*</span>yd<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>yd<span class="sc">*</span>yd<span class="sc">-</span>y<span class="sc">*</span><span class="fu">fdd</span>(x))</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x<span class="sc">-</span>dx <span class="co">#x &lt;- x-f(x)/fd(x)</span></span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(dx)<span class="sc">&lt;</span>acc){ <span class="fu">print</span>(citac); <span class="fu">return</span>(x)}</span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#rychlejší konvergence, méně iterací, ale potřebujeme druhou derivaci</span></span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a><span class="co">#zrychlená verze Newtonovy metody pro hledání kořenů funkcí, použ. druhou derivaci, výpočet druhé odmocniny čísla(a) pomocí Halleyho iterace (Xn+1=xn-(2f(x)f’(x))/(2(f’(x))^2-f(x)f’’(X))</span></span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a>HalleySquareRoot <span class="ot">&lt;-</span> <span class="cf">function</span>(a,<span class="at">acc=</span><span class="fl">0.000000001</span>){</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> a; citac <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#hledáme x aby platilo x^2=a, můžeme přepsat jako hled. kořene</span></span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{ citac <span class="ot">&lt;-</span> citac<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> x<span class="sc">*</span>x <span class="co">#využívá druhou derivaci a používá vylepšený vzorec</span></span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>  dx <span class="ot">&lt;-</span> (xx<span class="sc">-</span>a)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span>xx<span class="sc">+</span>a) <span class="co">#halleyho korekce</span></span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x<span class="sc">-</span>dx <span class="co">#x &lt;- x-f(x)/fd(x), aktualizace odhadu</span></span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(dx)<span class="sc">&lt;</span>acc){ <span class="fu">print</span>(citac); <span class="fu">return</span>(x)}</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="newtonova-metoda-využívající-hornerovo-schéma" class="level4">
<h4 class="anchored" data-anchor-id="newtonova-metoda-využívající-hornerovo-schéma">Newtonova metoda využívající hornerovo schéma</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#využívá Newtonovy metodu pro pro hledání kořenů s Hornerovým schématem k efektivnímu výpočtu hodnoty polynomu a jeho derivace v bodě</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>NewtonHorner <span class="ot">&lt;-</span> <span class="cf">function</span>(a,xstart,<span class="at">acc=</span><span class="fl">0.000000001</span>){ <span class="co">#acc-požadovaná přesnost</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n-stupeň polynomu(počet.koef),xstart-počáteční odhad kořene,citac-pocita iterace</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(a); x <span class="ot">&lt;-</span> xstart; citac <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    citac <span class="ot">&lt;-</span> citac <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> a[n] <span class="co">#inicializace P(x) s posledním koeficientem</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    yd <span class="ot">&lt;-</span> y <span class="co">#začátek výpočtu P'(x)</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">2</span>){ <span class="co">#procházíme koeficientyy polynomu</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> y<span class="sc">*</span>x<span class="sc">+</span>a[i] <span class="co">#přepíše polynom na iterativní formu, hodnota pol. P(x) v b. x</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>      yd <span class="ot">&lt;-</span> yd<span class="sc">*</span>x<span class="sc">+</span>y <span class="co">#hodnota derivace P'(x) v bodě x</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y<span class="sc">*</span>x<span class="sc">+</span>a[<span class="dv">1</span>]</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> y<span class="sc">/</span>yd <span class="co">#Newtonův krok: xn+1=xn-P(x)/P'(x)</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x<span class="sc">-</span>dx </span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cat(citac, ": ", x, "\n")</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(dx) <span class="sc">&lt;</span> acc) { <span class="fu">print</span>(citac); <span class="fu">return</span>(x) }</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>} <span class="co">#funguje jen na polynomy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># funkce f(funkce, jejíž kořeny hledáme), fd(první derivace) funkce f), fdd(druhá derivace) </span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(x<span class="sc">*</span>x<span class="sc">*</span>x<span class="sc">-</span><span class="fu">cos</span>(x))}; fd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="dv">3</span><span class="sc">*</span>x<span class="sc">*</span>x<span class="sc">+</span><span class="fu">sin</span>(x))}</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(x<span class="sc">*</span>x<span class="dv">-2</span>)}; fd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="dv">2</span><span class="sc">*</span>x)}; fdd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="dv">2</span>)}</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">20</span>) <span class="co">#nastavení vypisování čísel na 20 des. míst</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4142135623730951455</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NewtonRoot</span>(f,fd,<span class="fl">0.5</span>,<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4142135623730951455</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NewtonRoot</span>(f,fd,<span class="fl">0.5</span>,<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4142135623730949234</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NewtonRootVarB</span>(f,<span class="fl">0.5</span>,<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4142135623730949234</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NewtonRootVarC</span>(f,<span class="fl">0.5</span>,<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.4142135623730949234</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NewtonRootVarD</span>(f,fd,fdd,<span class="fl">0.5</span>,<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4142135623730951455</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">150</span>; <span class="fu">HalleySquareRoot</span>(a) <span class="co">#druha odmocnina ze 150</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.247448713915890295</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NewtonHorner</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>) <span class="co">#vypocet korene polynonu x2-2 s počátečním odhadem x0=2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4142135623730951455</code></pre>
</div>
</div>
</section>
<section id="chebyshev-polynoms" class="level4">
<h4 class="anchored" data-anchor-id="chebyshev-polynoms">Chebyshev polynoms</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#funkce pro generování a výpočet koeficintů Čebyševových polynomů</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>ChebyshevCoef <span class="ot">&lt;-</span> <span class="cf">function</span>(n){ <span class="co"># n(počet Čebyševových polynomů, které se mají vygenerovat)</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#vytvoří se prázdné vektory a0 a a1. Pro první a druhý polynom jsou nastaveny specicické hodnoty (T0(x) = 1 a T1(x) =x)</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  a0 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n); a0[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#první čeb. polynom T0(x) = 1</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n<span class="sc">==</span><span class="dv">1</span>) <span class="fu">return</span>(a0) <span class="co">#pokud n=1 vrátíme koeficienty polynomu T0(x)=1</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  a1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n); a1[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#druhý čeb. polynom T1(x) = x</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n<span class="sc">==</span><span class="dv">2</span>) <span class="fu">return</span>(a1) <span class="co">#pokud n=2 vrátíme koeficienty T1(x)=x</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n){ <span class="co">#uchováváme 2 poslední polynomy Tn-2(x) a Tn-1(x)</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>, a1[<span class="sc">-</span>n])<span class="sc">-</span>a0 <span class="co">#použítím rek. rci.: Tn(x)=2xTn-1(x)-Tn-2(x)</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    a0 <span class="ot">&lt;-</span> a1 <span class="co">#posuneme polynomy</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>    a1 <span class="ot">&lt;-</span> a</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a) <span class="co">#vrátíme koeficienty posl. polynomu T_n(x)</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>} <span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="newtonova-metoda-hledání-kořenů-funkce" class="level4">
<h4 class="anchored" data-anchor-id="newtonova-metoda-hledání-kořenů-funkce">Newtonova metoda (hledání kořenů funkce)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#iterativní metoda hledání kořene funkce, f(funkce, pro kterou hledáme kořen), fd(derivace funkce f), x0(počáteční odhad kořene),tol(tolerance chyby, při které algoritmus skončí)</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>Newton <span class="ot">&lt;-</span> <span class="cf">function</span>(f, fd, x0, <span class="at">tol=</span><span class="fl">0.0000001</span>){  <span class="co">#s první i druhou derivací</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x0 <span class="co">#za x0 si dosadíme odhad</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> <span class="fu">f</span>(x)<span class="sc">/</span><span class="fu">fd</span>(x) <span class="co">#dx=f(x)/fd(x)</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(dx) <span class="sc">&lt;</span> tol) <span class="fu">return</span>(x)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">-</span> dx</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#vrací kořen</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Newtonova metoda na polynomu pomocí Hornerova schématu</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>NewtonHorner <span class="ot">&lt;-</span> <span class="cf">function</span>(a, x0, <span class="at">tol=</span><span class="fl">0.0000001</span>){ <span class="co">#a(koeficienty polynomu), x0(počáteční odhad kořene), tol(tolerance chyby) </span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Funkce volá Horner pro výpočet hodnoty polynomu a jeho derivace v bodě x. Iterace probíhá podobně jako v Newton</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x0</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">Horner</span>(a, x)</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> res[<span class="dv">1</span>]<span class="sc">/</span>res[<span class="dv">2</span>]</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(dx) <span class="sc">&lt;</span> tol) <span class="fu">return</span>(x)</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">-</span> dx</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#vrací nalezený kořen</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Horner pro efektivní výpočet polynomu a jeho derivace v daném bodě x pomocí redukce počtu operací, dobře funguje na velké polynomy</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(a, x){ <span class="co">#a(Koeficienty polynomu)</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(a); y <span class="ot">&lt;-</span> a[n] </span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>    yd <span class="ot">&lt;-</span> y <span class="co">#inicializace hodnoty derivace</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">2</span>){</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> y<span class="sc">*</span>x<span class="sc">+</span>a[i] <span class="co">#iterativní výpočet hodn. polynomu</span></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>        yd <span class="ot">&lt;-</span> yd<span class="sc">*</span>x<span class="sc">+</span>y <span class="co">#iterativní výpočet derivace</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y<span class="sc">*</span>x<span class="sc">+</span>a[<span class="dv">1</span>] <span class="co">#poslední iterace pro hodnotu polynomu</span></span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(y, yd)) <span class="co">#vrátí hodnotu polynomu a derivace</span></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a>  }<span class="co">#iteruje přes koeficienty a efektivně spočítá hodnotu polynomu a derivace</span></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(y, <span class="dv">0</span>)) <span class="co">#pokud je polynom konstantní derivace je 0</span></span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Alternativa k Horner, která počítá hodnotu polynomu a jeho derivace přímo pomocí mocnin x. Výpočet je méně efektivní, prot. kaž. iterace znovu poč. mocniny</span></span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>PolX <span class="ot">&lt;-</span> <span class="cf">function</span>(a, x){</span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(a); y <span class="ot">&lt;-</span> <span class="dv">0</span>; yd <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#počet koef, hodn. polynomu, hodn. derivace</span></span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y <span class="sc">+</span> a[i]<span class="sc">*</span>x<span class="sc">^</span>(i<span class="dv">-1</span>) <span class="co">#přímý výpočet polynomů</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a>    yd <span class="ot">&lt;-</span> yd <span class="sc">+</span> (i<span class="dv">-1</span>)<span class="sc">*</span>a[i]<span class="sc">*</span>x<span class="sc">^</span>(i<span class="dv">-2</span>) <span class="co">#přímý výpočet derivace</span></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(y,yd)) <span class="co">#Vrátí hodnotu polynomu a jeho derivace</span></span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a>} <span class="co">#pro velké polynomy výrazně pomalejší, nevyužívá rekurentní vztahy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">3</span>; x <span class="ot">&lt;-</span> <span class="dv">2</span>; a <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) <span class="co">#gen. náh koeficientů </span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Horner</span>(a, x); <span class="fu">PolX</span>(a, x) <span class="co">#výpočet hodnoty polynomu a derivace v daném bodě</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.5368725557345896959 1.4279896751977503300</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.5368725557345896959 1.4279896751977503300</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.0001</span>) <span class="co">#porovnání výsledků funkcí Horner a Polx grafy</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">cos</span>(x), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'red'</span>)<span class="co">#porovnává funkci cos(x) a diagonálu y=x</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, x, <span class="at">col=</span><span class="st">'green'</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#výpočet bodu průsečíku</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>inters <span class="ot">&lt;-</span> <span class="fu">Newton</span>(<span class="at">f =</span> <span class="cf">function</span>(x) <span class="fu">cos</span>(x)<span class="sc">-</span>x, <span class="at">fd =</span> <span class="cf">function</span>(x) <span class="sc">-</span><span class="fu">sin</span>(x)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="at">tol=</span><span class="fl">0.0000001</span>)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(inters, <span class="fu">cos</span>(inters), <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">cex=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NewtonHorner</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">2</span>) <span class="co">#výpočet korene polynomu s odhadem</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4142135623746898698</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.0001</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Čebyševovy polynomy</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">sapply</span>(x, <span class="cf">function</span>(x) <span class="fu">Horner</span>(<span class="fu">ChebyshevCoef</span>(<span class="dv">1</span>), x)[<span class="dv">1</span>]), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'black'</span>) <span class="co">#čára</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#vykreslení sincos funkcí</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>) <span class="fu">lines</span>(x, <span class="fu">sapply</span>(x, <span class="cf">function</span>(x) <span class="fu">Horner</span>(<span class="fu">ChebyshevCoef</span>(i), x)[<span class="dv">1</span>]), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span>i<span class="sc">+</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bisekce-hledání-kořene-funkce" class="level4">
<h4 class="anchored" data-anchor-id="bisekce-hledání-kořene-funkce">Bisekce (hledání kořene funkce)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hledání kořene funkce f(x) v daném intervalu [a,b]</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>bisekce <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b){<span class="co">#f(funkce, jejiž kořen hledáme)</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#funguje na principu opakovaného(iterativního) půlení intervalu, dokud nenajdeme dostatečně přesný přibližný kořen</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  fa <span class="ot">&lt;-</span> <span class="fu">f</span>(a); fb <span class="ot">&lt;-</span> <span class="fu">f</span>(b) <span class="co">#vypočítáme hodnotu pro začátek f(a) a konec f(b) int.</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fa<span class="sc">*</span>fb <span class="sc">&lt;</span> <span class="dv">0</span>){ <span class="co">#ověří se zda interval obsahuje kořen (f(a)* f(b) &lt; 0 tj. hodnoty musí mít opačné znaménko, aby metoda fungovala, že existuje mezi nimi kořen.)</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">repeat</span>{</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>      c <span class="ot">&lt;-</span> (a<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span> <span class="co">#najdem střed intervalu</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(c <span class="sc">==</span> a <span class="sc">||</span> c <span class="sc">==</span> b) <span class="fu">return</span>(c) <span class="co">#pokud se interval už nemění,tak vrátíme kořen</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>      fc <span class="ot">&lt;-</span> <span class="fu">f</span>(c)<span class="co">#vypočítáme hodnotu středu f(c), pokud je blízko 0 našli jsme kořen</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(fa<span class="sc">*</span>fc <span class="sc">&lt;</span> <span class="dv">0</span>) { <span class="co">#pokud f(a)(první interval) a f(c)(střed) mají opačné              znaménko, kořen je v (a,c)</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>        b <span class="ot">&lt;-</span> c</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>        fb <span class="ot">&lt;-</span> fc </span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{ <span class="co">#jinak je kořen v (c,b)</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>        a <span class="ot">&lt;-</span> c</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>        fa <span class="ot">&lt;-</span> fc</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#hodí se například, když chci jistotu, že kořen existuje</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{ <span class="fu">stop</span>(<span class="st">"Spatne vstupni zadani"</span>); <span class="fu">return</span>(<span class="cn">FALSE</span>) } <span class="co">#Pokud f(a) * f(b) &gt;= 0, tak interval neobsahuje kořen</span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>}<span class="co">#je robustní a jednoduchá,ale konverguje pomalu,vždy najde kořen(pokud podmínky),použ. se jako zákl. metoda,ale pro rychlejší výsledky je např. Newtonova metoda</span></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">bisekce</span>(<span class="cf">function</span>(x) x<span class="sc">*</span>x<span class="dv">-2</span>, <span class="dv">0</span>, <span class="dv">2</span>)) <span class="co">#Funkce hledá kořen rovnice x**2 - 2 = 0 na intervalu (0,2), což je odmocnina ze 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4142135623730949234</code></pre>
</div>
</div>
</section>
</section>
<section id="prostá-iterace-funkcí-fixpointová-metoda" class="level3">
<h3 class="anchored" data-anchor-id="prostá-iterace-funkcí-fixpointová-metoda">Prostá iterace funkcí (fixpointová metoda)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="fu">sqrt</span>(x<span class="sc">+</span><span class="dv">10</span>)<span class="sc">/</span>x)} <span class="co">#pro Číselné metody</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="fl">0.5</span><span class="sc">*</span>(x<span class="sc">+</span><span class="dv">2</span><span class="sc">/</span>x))} <span class="co">#fce.(metoda Heronova vzorce pro odmocninu)</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(x<span class="sc">+</span><span class="dv">2</span>))} <span class="co">#fce. g(x) = 2*ln(x+2), která se iterativně přibližuje k pevnému bodu</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">#hledání pevných bodů funkcí g(x), hledáme hodnotu x, kt. se nemění</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>fixpoint1 <span class="ot">&lt;-</span> <span class="cf">function</span>(g, x){</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){ y <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="co">#iterace vypočítá novou hodnotu y=g(x), zobrazí         vizualizaci procesu (zelené segnemty v grafu)</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">segments</span>(x,x,x,y,<span class="at">col=</span><span class="st">"green"</span>) <span class="co">#vertikální čára </span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">segments</span>(x,y,y,y,<span class="at">col=</span><span class="st">"green"</span>) <span class="co">#horizontální čára</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> y; <span class="co">#print(x) </span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  }<span class="co">#proces opakujeme dokud xn nepřestane výrazně měnit hodnotu(nenalezneme pev.bod)</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>fixpoint2 <span class="ot">&lt;-</span> <span class="cf">function</span>(g, n){</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">40</span>; x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n); x[<span class="dv">1</span>] <span class="ot">&lt;-</span> xstart <span class="co">#zvolíme počáteční bod x0</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){ <span class="co"># Vykreslení posloupnosti iterací</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">g</span>(x[i<span class="dv">-1</span>]) <span class="co">#iterativně vypočítáme posloupnost xn+1=g(xn)</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">segments</span>(<span class="at">x0=</span>x[i<span class="dv">-1</span>], <span class="at">x1=</span>x[i<span class="dv">-1</span>], <span class="at">y0 =</span> x[i<span class="dv">-1</span>], <span class="at">y1 =</span> x[i], <span class="at">col=</span><span class="st">'lightgreen'</span>)</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">segments</span>(<span class="at">x0=</span>x[i<span class="dv">-1</span>], <span class="at">x1=</span>x[i], <span class="at">y0 =</span> x[i], <span class="at">y1 =</span> x[i], <span class="at">col=</span><span class="st">'lightgreen'</span>)</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(x[i])</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>xstart <span class="ot">&lt;-</span> <span class="dv">5</span>; <span class="fu">plot</span>(g, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, xstart), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, xstart), <span class="at">col=</span><span class="st">'blue'</span>)</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">'red'</span>) <span class="co">#a + b * x</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a><span class="fu">fixpoint2</span>(g,<span class="at">n=</span><span class="dv">10</span>) <span class="co">#pomocí funkce g(x), iterační proces se vykreslí pomocí zelených segmentů, které sigualizují skákání hodnot mezi funkcí g(x) a diagonálou x=y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#př.1,funkce g2(x) heronovy metody(newtonovy iterace) pro výpočet odmocniny</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.01</span>); <span class="fu">plot</span>(x,<span class="fu">g2</span>(x),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">type=</span><span class="st">'l'</span>,<span class="at">col=</span><span class="st">'blue'</span>) <span class="co">#graf funkce g(x)</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">'red'</span>) <span class="co">#přímka y=x (diagonála)</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fixpoint1</span>(g2,x) </span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fixpoint2</span>(g2,<span class="at">n=</span><span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#př. 2, iterační proces s funkcí cos(x), iterace se snaží najít pevný bod, který konverguje ke kořenu rovnice cos(x) = x, je pro dynamické systémy</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cos,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>),<span class="at">col=</span><span class="st">"blue"</span>); <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">'red'</span>) <span class="co">#vykreslí graf cos(x) a diagonálu y=x, iterativně hledá pevný bod, kde cos(x)=x</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fl">0.1</span>; <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){ y <span class="ot">&lt;-</span> <span class="fu">cos</span>(x); <span class="fu">segments</span>(x,x,x,y,<span class="at">col=</span><span class="st">"green"</span>); <span class="fu">segments</span>(x,y,y,y,<span class="at">col=</span><span class="st">"green"</span>); x <span class="ot">&lt;-</span> y; <span class="fu">print</span>(x) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-47-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.99500416527802582056
[1] 0.54449939582778839053
[1] 0.85538670587936049827
[1] 0.65592666367047980369
[1] 0.79248310194480942048
[1] 0.70207926799067021939
[1] 0.76350103369188537794
[1] 0.72241963623897320623
[1] 0.75020805887529062872
[1] 0.73154703204422399931</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#př. 3, log. fce. g(x) = 2*ln(x+2), která se iterativně přibližuje k pevnému bodu, použití v některých dif. rovnicích a mod. reálných procesů ve fyzice</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.01</span>); <span class="fu">plot</span>(x,<span class="fu">g3</span>(x),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">type=</span><span class="st">'l'</span>,<span class="at">col=</span><span class="st">"blue"</span>); <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">'red'</span>)<span class="co">#Iterativná proces vizualizuje přibližení k pevnému bodu.</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fl">0.1</span>; <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){ y <span class="ot">&lt;-</span> <span class="fu">g3</span>(x); <span class="fu">segments</span>(x,x,x,y,<span class="at">col=</span><span class="st">"green"</span>); <span class="fu">segments</span>(x,y,y,y,<span class="at">col=</span><span class="st">"green"</span>); x <span class="ot">&lt;-</span> y; <span class="fu">print</span>(x) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-47-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4838746894587546699
[1] 2.4962901818181424396
[1] 3.0065053054559367496
[1] 3.2214762557574374569
[1] 3.3055603390567576128
[1] 3.3375107823848684241
[1] 3.3495187973432947182
[1] 3.3540132248817182692
[1] 3.3556928303776385469
[1] 3.3563201512400500093</code></pre>
</div>
</div>
<section id="iterace-pro-řeš.-dif.-rovnic" class="level4">
<h4 class="anchored" data-anchor-id="iterace-pro-řeš.-dif.-rovnic">Iterace pro řeš. dif. rovnic</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#př. 4 pro řeš dif rovnic</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){<span class="fu">return</span>((<span class="dv">1</span><span class="sc">+</span>y<span class="sc">*</span>y)<span class="sc">/</span>(x<span class="sc">*</span>y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">*</span>x)))} <span class="co">#dif. rce. ve tvaru dy/dx s počáteční podmínkou y(x0)=y0</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(y1){<span class="fu">return</span>(y0<span class="sc">+</span>hpul<span class="sc">*</span>(<span class="fu">f</span>(x1,y1)<span class="sc">+</span><span class="fu">f</span>(x0,y0)))}<span class="co">#heunova korekce funkce g(y1), používá průměr. hodnotu der. v bodech(x0,y0)a(x1,y1), slouží ke korekci derivované hodnoty y1 po první aproximaci</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>step <span class="ot">&lt;-</span> <span class="cf">function</span>(f, h, x0, y0){ <span class="co">#predikce pomocí eulerovy metody</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  hpul <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>h <span class="co">#poloviční krok pro korekci</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> x0<span class="sc">+</span>h <span class="co">#posun na další bod</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(x0,y0) <span class="co">#Predikce (Eulerova metoda)</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#iterativní korekce pomocí průměrné derivace, opakuje se 10x</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) y1 <span class="ot">&lt;-</span> y0<span class="sc">+</span>hpul<span class="sc">*</span>(<span class="fu">f</span>(x1,y1)<span class="sc">+</span><span class="fu">f</span>(x0,y0)) </span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y1)</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Hlavní smyčka–numerické řešení ODR, x je diskretizace intervalu</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fl">0.1</span>; x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, h); n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n); y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#poč.podmn.</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">#postupně poč. hodnoty y pro všechny x</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) y[i] <span class="ot">&lt;-</span> <span class="fu">step</span>(f, h, x[i<span class="dv">-1</span>], y[i<span class="dv">-1</span>]) </span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co">#grafické znázornění-(pointy)numericky vypočtené hodnoty pomocí derivace a (lines) analytické řešení rovnice</span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">col =</span> <span class="st">'blue'</span>); <span class="fu">lines</span>(x, <span class="fu">sqrt</span>((<span class="dv">3</span><span class="sc">*</span>x<span class="sc">*</span>x<span class="dv">-1</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">*</span>x)), <span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sir-a-lv-model" class="level4">
<h4 class="anchored" data-anchor-id="sir-a-lv-model">SIR a LV model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,beta,nu){ <span class="co">#SIR model (simulace šíření infekce v populaci)</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dS = -betaSI(počet náchylných k infekci), DI= BetaSI-vI(změna počtu infikovaných), dR = vI(přírůstek uzdravených)</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  dS <span class="ot">&lt;-</span> <span class="sc">-</span>beta<span class="sc">*</span>x[<span class="dv">1</span>]<span class="sc">*</span>x[<span class="dv">2</span>]</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  dI <span class="ot">&lt;-</span> beta<span class="sc">*</span>x[<span class="dv">1</span>]<span class="sc">*</span>x[<span class="dv">2</span>]<span class="sc">-</span>nu<span class="sc">*</span>x[<span class="dv">2</span>]</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  dR <span class="ot">&lt;-</span> nu<span class="sc">*</span>x[<span class="dv">2</span>]</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(dS,dI,dR))</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co">#explicitní metoda (Eulerovu metoda a postupná korekce) pro výpočet dalšího kroku</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(h,f,y0,beta,nu){ </span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(y0,beta,nu)</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="fl">+0.5</span><span class="sc">*</span>h<span class="sc">*</span>(<span class="fu">f</span>(y0,beta,nu)<span class="sc">+</span><span class="fu">f</span>(y1,beta,nu))</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="fl">+0.5</span><span class="sc">*</span>h<span class="sc">*</span>(<span class="fu">f</span>(y0,beta,nu)<span class="sc">+</span><span class="fu">f</span>(y1,beta,nu))</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="fl">+0.5</span><span class="sc">*</span>h<span class="sc">*</span>(<span class="fu">f</span>(y0,beta,nu)<span class="sc">+</span><span class="fu">f</span>(y1,beta,nu))</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="fl">+0.5</span><span class="sc">*</span>h<span class="sc">*</span>(<span class="fu">f</span>(y0,beta,nu)<span class="sc">+</span><span class="fu">f</span>(y1,beta,nu))</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y1)</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>nrow <span class="ot">&lt;-</span> <span class="dv">3000</span>; ncol<span class="ot">&lt;-</span><span class="dv">3</span>; SIR <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nrow,ncol); SIR[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">999</span>,<span class="dv">1</span>,<span class="dv">0</span>)<span class="co">#Inicializace populace (S=999.I=1, R=0)</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.05</span>; nu <span class="ot">&lt;-</span> <span class="fl">0.5</span>; h <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nrow) SIR[i,] <span class="ot">&lt;-</span> <span class="fu">g</span>(h,f,SIR[i<span class="dv">-1</span>,],beta,nu) <span class="co">#iteruje 5000 kroků a aktualizuje počty Grafy</span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>cas <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nrow</span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cas,SIR[,<span class="dv">1</span>],<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>),<span class="at">type=</span><span class="st">'l'</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cas,SIR[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cas,SIR[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"S(náchylní)"</span>, <span class="st">"I(infikovaní)"</span>, <span class="st">"R(uzdravení)"</span>),<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lotka volterra model(interakce mezi predátory a kořistí),dx/dt=x(r-ay): změna populace kořsti dy/dt=y(-s+bx): změna populace predátorů</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>f_LV <span class="ot">&lt;-</span> <span class="cf">function</span>(x,r,a,s,b){ <span class="fu">return</span>(<span class="fu">c</span>(x[<span class="dv">1</span>]<span class="sc">*</span>(r<span class="sc">-</span>a<span class="sc">*</span>x[<span class="dv">2</span>]),x[<span class="dv">2</span>]<span class="sc">*</span>(<span class="sc">-</span>s<span class="sc">+</span>b<span class="sc">*</span>x[<span class="dv">1</span>])))} <span class="co"># dx,dy, definuje změny v počtu kořistí a predátorů</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametry jsou r,s(míry růstu) a a,b(míry interakce)</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(h,f,y0,r,a,s,b){ </span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="sc">+</span>h<span class="sc">*</span><span class="fu">f</span>(y0,r,a,s,b)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="fl">+0.5</span><span class="sc">*</span>h<span class="sc">*</span>(<span class="fu">f</span>(y0,r,a,s,b)<span class="sc">+</span><span class="fu">f</span>(y1,r,a,s,b))</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="fl">+0.5</span><span class="sc">*</span>h<span class="sc">*</span>(<span class="fu">f</span>(y0,r,a,s,b)<span class="sc">+</span><span class="fu">f</span>(y1,r,a,s,b))</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="fl">+0.5</span><span class="sc">*</span>h<span class="sc">*</span>(<span class="fu">f</span>(y0,r,a,s,b)<span class="sc">+</span><span class="fu">f</span>(y1,r,a,s,b))</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y0<span class="fl">+0.5</span><span class="sc">*</span>h<span class="sc">*</span>(<span class="fu">f</span>(y0,r,a,s,b)<span class="sc">+</span><span class="fu">f</span>(y1,r,a,s,b))</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y1)</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>nrow <span class="ot">&lt;-</span> <span class="dv">15000</span>; LV <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>nrow,<span class="at">ncol=</span><span class="dv">2</span>); LV[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>)<span class="co">#inicializace(x=10), (y=10)</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">1</span>; s <span class="ot">&lt;-</span> <span class="dv">5</span>; a <span class="ot">&lt;-</span> <span class="fl">0.1</span>; b <span class="ot">&lt;-</span> <span class="fl">0.02</span>; h <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nrow) LV[i,] <span class="ot">&lt;-</span> <span class="fu">g</span>(h,f_LV,LV[i<span class="dv">-1</span>,],r,a,s,b) <span class="co">#iterace 5000 kroků pomocí metody g</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nrow</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time,LV[,<span class="dv">1</span>],<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2000</span>),<span class="at">type=</span><span class="st">'l'</span>,<span class="at">col=</span><span class="st">"red"</span>) <span class="co">#vývoj populace (červená kořist, modrá predátoři)</span></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,LV[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"blue"</span>) </span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Kořist"</span>, <span class="st">"Predátor"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-49-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LV[,<span class="dv">1</span>], LV[,<span class="dv">2</span>]) <span class="co">#x vs y (cyklický diagram)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-49-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="numerické-derivace-integrace-interpolace" class="level3">
<h3 class="anchored" data-anchor-id="numerické-derivace-integrace-interpolace">Numerické derivace, integrace, interpolace</h3>
<section id="numerická-derivace-funkce" class="level4">
<h4 class="anchored" data-anchor-id="numerická-derivace-funkce">Numerická derivace funkce</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerická derivace f’(x) vyp. pomocí centrální diference f’(x) = f(x+h)-f(x-h)/2h a Richardsonový extrapolace pro zvýšení přesnosti </span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>f_der <span class="ot">&lt;-</span> <span class="cf">function</span>(f ,x ,h ,<span class="at">n =</span> <span class="dv">2</span>){ </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> h<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span>(n<span class="dv">-1</span>)) <span class="co">#postupně zmenšujeme krok h, extrapolace(zvýšení přesnosti)</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> (<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="fu">f</span>(x<span class="sc">-</span>h))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>h) <span class="co">#výpočet centrální diference (je přesnější než dopředná a zpětná)</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> n</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>   <span class="co">#zpřesnění pomocí rekurzivní rovnice, kde a je faktor zmenšení kroku</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> (a<span class="sc">*</span>res[<span class="dv">2</span><span class="sc">:</span>m]<span class="sc">-</span>res[<span class="dv">1</span><span class="sc">:</span>(m<span class="dv">-1</span>)])<span class="sc">/</span>(a<span class="dv">-1</span>)</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> m<span class="dv">-1</span> <span class="co">#Richardsonova extrapolace</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>} <span class="co">#O(h^2)střední přesnost, snadná implementace</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x, hmax, <span class="at">n =</span> <span class="dv">1</span>){<span class="co">#f(funkce, jejiž derivaci počítáme),x(bod, ve kterém derivace),hmax(maximální krok, který se postupně zmenšuje), n(počet iterací extrapolace, která zvyšuje přesnost) </span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> hmax<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span>(n<span class="dv">-1</span>)) <span class="co">#zmenšuje krok h postupně</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> (<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="fu">f</span>(x<span class="sc">-</span>h))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>h) <span class="co">#výpočet derivace pomocí centrální diference</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>){ </span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>      m <span class="ot">&lt;-</span> n<span class="sc">-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>      power <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">^</span>i <span class="co">#faktor zlepšení přesnosti, zde se používá mocnina 4 místo 2</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">&lt;-</span> (power<span class="sc">*</span>res[<span class="dv">2</span><span class="sc">:</span>m]<span class="sc">-</span>res[<span class="dv">1</span><span class="sc">:</span>(m<span class="dv">-1</span>)])<span class="sc">/</span>(power<span class="dv">-1</span>)</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>    } <span class="co">#rychlejší konvergence k přesnějšímu výsledku</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#O(h^4) má vysokou přesnost při malých hodnotách h </span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>}<span class="co">#výpočty derivací pro num. analýzu,přesné diferenciace,kde nelze použít anal. der.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="midpointrule-num.-integrace" class="level4">
<h4 class="anchored" data-anchor-id="midpointrule-num.-integrace">MidPointRule (num. integrace)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Numerická integrace (Midpoint Rule)-vypočítá se šířka kroku h=(b-a)/n, sečtou se hodnoty funkce f(x) ve středních bodech intervalů, výsledek se vynásobí krokem h, čímž se získá aproximace int.</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>MidPointRule <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b,n){ h <span class="ot">&lt;-</span> (b<span class="sc">-</span>a)<span class="sc">/</span>n; <span class="fu">return</span>(h<span class="sc">*</span><span class="fu">sum</span>(<span class="fu">f</span>(h<span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span>n)<span class="sc">+</span>a<span class="sc">-</span>h<span class="sc">/</span><span class="dv">2</span>)))} <span class="co">#Integrál od a do b f(x)dx vlnovka h suma od n po i=l f(a+2i-1-/2h), kde h=b-a/n), </span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co">#integrace aplikuje Richardsonovu extrapolaci na výsledky metody středního bodu, což výrazně zvušuje přesnost integrace</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>MidPointRuleRichardson <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b,<span class="at">n=</span><span class="dv">2</span>){</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> n</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span>(n<span class="dv">-1</span>)) <span class="co">#generuje hodnoty (násobky 2)</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n,<span class="cf">function</span>(n) <span class="fu">MidPointRule</span>(f,a,b,n))<span class="co">#výpočty intergrálů pro různé n</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>i<span class="dv">-2</span>) <span class="co">#faktor zlepšení přesnosti</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> (a<span class="sc">*</span>res[<span class="dv">2</span><span class="sc">:</span>m]<span class="sc">-</span>res[<span class="dv">1</span><span class="sc">:</span>(m<span class="dv">-1</span>)])<span class="sc">/</span>(a<span class="dv">-1</span>) <span class="co">#richardsonova extrapolace</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> m<span class="dv">-1</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#pomocí extrapolace přesnost O(h^4), vysoká přesnost</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>}<span class="co"># pro num. integrace funkcí, kde neexistuje analytický vzorec, nebo pro výpočty v simulacích, fyzice, ekonomii atd...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hermitova-interpolace-používá-derivace" class="level4">
<h4 class="anchored" data-anchor-id="hermitova-interpolace-používá-derivace">Hermitova interpolace (používá derivace)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hermitova interpolace, aproximuje funkci na základě hodnot v určitých bodech a také i zohledňuje jejich derivace v bodech (x0,x1) na rozdíl od Lagrangeovy int.</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="co">#x0,x1: body interpolace, y0,y1: hodnoty funkce v těchto bodech, d0,d1: hodnoty derivace v těchto bodech, polynom: P(x)=a+b(x-x0)+c(x-x0)^2+d(x-x0)^3</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>Hermite <span class="ot">&lt;-</span> <span class="cf">function</span>(x0,x1,y0,y1,d0,d1){ </span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> y0; b <span class="ot">&lt;-</span> d0; h <span class="ot">&lt;-</span> x1<span class="sc">-</span>x0; h2 <span class="ot">&lt;-</span> h<span class="sc">*</span>h <span class="co">#koeficienty: a=y0, b=d0</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> (h<span class="sc">*</span>(d1<span class="sc">-</span>d0)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(y1<span class="sc">-</span>y0)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>d0<span class="sc">*</span>h)<span class="sc">/</span>(h<span class="sc">*</span>h2) <span class="co">#výpočet koeficientu d</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> (d1<span class="sc">-</span>d0<span class="dv">-3</span><span class="sc">*</span>d<span class="sc">*</span>h2)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>h) <span class="co">#výpočet koeficientu c</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(a,b,c,d)) <span class="co"># Vrací koeficienty interpolujícího polynomu, který je pak použit ve funkci Horner pro hodnocení hodnot interpolovaného polynomu</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>} <span class="co">#je složitější, ale přesnější než Lagrane nebo Newton, je vhodná když máme hodnoty funkce i její derivace</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Vyhodnocení hodnot interpolovaného polynomu pomocí hornerova schématu s koeficienty(a,b,c,d)</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(coef,x,x0){ x <span class="ot">&lt;-</span> x<span class="sc">-</span>x0; <span class="fu">return</span>(((coef[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">+</span>coef[<span class="dv">3</span>])<span class="sc">*</span>x<span class="sc">+</span>coef[<span class="dv">2</span>])<span class="sc">*</span>x<span class="sc">+</span>coef[<span class="dv">1</span>])}</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co">#používá se napříkladd v poč. grafice, num. analýze nebo aproximaci dat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f_der</span>(sin, pi<span class="sc">/</span><span class="dv">4</span>, <span class="fl">0.1</span>, <span class="dv">3</span>) <span class="co">#numerická derivace funkce sin(x) v bodě pí/4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.70572438546641069745</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">0</span>; b <span class="ot">&lt;-</span> pi</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">MidPointRule</span>(sin,a,b,<span class="dv">100</span>); <span class="fu">MidPointRuleRichardson</span>(sin,a,b,<span class="dv">5</span>)<span class="co">#Výpočet integrálu na intervalu od 0 do pí sin(x)dx pomocí metody středního bodu a Richardsonovy extrapolace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.0000822490709859736</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.0000000054047775144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#x jsou body interpolace,y jsou hodnoty funkce v bodech, d jsou hodnoty derivace v bodech y</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> pi; x1 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>pi; y0 <span class="ot">&lt;-</span> <span class="fu">cos</span>(x0); y1 <span class="ot">&lt;-</span> <span class="fu">cos</span>(x1); d0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sin</span>(x0); d1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sin</span>(x1)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cos,<span class="at">xlim=</span><span class="fu">c</span>(x0,x1),<span class="at">col=</span><span class="st">"red"</span>) <span class="co">#vykreslení skutečné funkce cos(x)</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(x0,x1,<span class="fl">0.001</span>) <span class="co">#vytvoření bodů pro interpoalci v intervalu (pí,2pí) </span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">Horner</span>(<span class="fu">Hermite</span>(x0,x1,y0,y1,d0,d1),x,x0),<span class="at">col=</span><span class="st">"blue"</span>) <span class="co">#interpolované polynomy s různými počátečními derivacemi, hermitova interpolace</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">Horner</span>(<span class="fu">Hermite</span>(x0,x1,y0,y1,<span class="sc">-</span><span class="dv">1</span>,d1),x,x0),<span class="at">col=</span><span class="st">"green"</span>)<span class="co">#variace s jinou derivací</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#vykreslení funkce pomocí centrální derivace</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="dv">2</span><span class="sc">^</span>x)}</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="dv">2</span><span class="sc">^</span>x<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi), <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fl">0.000000001</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) (<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="fu">f</span>(x))<span class="sc">/</span>h, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi), <span class="at">col=</span><span class="st">'green'</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-53-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(x<span class="sc">*</span>x<span class="dv">-2</span>)}; fd <span class="ot">&lt;-</span>  <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="dv">2</span><span class="sc">*</span>x)}</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co">#výpočti funkcí (stejný jako předtím)</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co">#x &lt;- 2000000000; res &lt;- sqrt(2); for(i in 1:100){ x &lt;- x - f(x)/fd(x); cat(res,"\n", x,"---------") }</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(midpointrule(function(x) x^2*sin(x), 0, pi, 10000))</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="co">#num. der. exp. fce.</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="co">#for(x in 0:5){ cat(exp(x), fd(exp, x, 0.01, 3), "\n") } #porovnává hodnotu e na x s numericky spočítanou derivací pomocí fd(výsledky jsou blízko k analytické derivaci e na x)</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co">#for(n in 1:5){ print(fd(sin, pi/4, 1, n)) } #derivace funkce sin(x) v bodě pí/4, která zlepšuje přesnost Richardsonovu extrapolaci (přesnost výsledku se zvyšuje s rostoucím n)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="laplaceova-rovnice" class="level4">
<h4 class="anchored" data-anchor-id="laplaceova-rovnice">Laplaceova rovnice</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#iterační řešení laplaceovy rovnice (je parciální dif. rovnice, která popisuje stacionární(časově neměnné fyz. procesy, jako jsou tepelná vodivost,...)), vypadá takto: (d^2u/dx^2)+(d^2u/dy^2)=0</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">50</span>) <span class="co">#Matice A o rozměrech 50*50 reprezentuje mřížku 2D prostoru</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#Horní okraj mřížky je nastaven na hodnotu 100, ostatní body na 0</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">49</span>){</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">49</span>){</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>      A[i,j] <span class="ot">&lt;-</span> <span class="fl">0.25</span><span class="sc">*</span>(A[i<span class="dv">-1</span>,j] <span class="sc">+</span> A[i<span class="sc">+</span><span class="dv">1</span>, j] <span class="sc">+</span> A[i, j<span class="dv">-1</span>] <span class="sc">+</span> A[i, j<span class="sc">+</span><span class="dv">1</span>]) <span class="co">#Iterativcně se aktualizují hodnoty uvnitř mřížky pomocí váženého průměru hodnot okolních bodů uij= 1/(ui-1,+ui+1,j atd…)</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(A[<span class="dv">25</span>,<span class="dv">25</span>]) <span class="co">#střed mřížky</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25.851134611832129906</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Vykreslení vizualizace heatmapy výsledné matice</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2); <span class="fu">library</span>(scales)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(A)), <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heatmap of Matrix Values"</span>, <span class="at">x =</span> <span class="st">"Row"</span>, <span class="at">y =</span> <span class="st">"Column"</span>, <span class="at">fill =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">48</span><span class="sc">*</span><span class="dv">48</span>; A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n); b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co">#Matice A a vektor b odpovídají Laplaceově rovnici na mřížce 48*48 (bez okrajových bodů), Ax=b</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">49</span>){ <span class="co">#Každý bod mřížky je reprezentován jednou rovnicíí, kde diagonální prvek odpovídá hodnotě bodu a okolní prvky jeho sousedům.</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">49</span>){</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> (i<span class="dv">-2</span>)<span class="sc">*</span><span class="dv">48</span><span class="sc">+</span>j<span class="dv">-1</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>    A[k,k] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">&gt;</span> <span class="dv">2</span>) A[k, k<span class="dv">-48</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">2</span>) b[k] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">&lt;</span> <span class="dv">49</span>) A[k, k<span class="sc">+</span><span class="dv">48</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(j <span class="sc">&gt;</span> <span class="dv">2</span>) A[k, k<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(j <span class="sc">&lt;</span> <span class="dv">49</span>) A[k, k<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a><span class="co">#hodnota v bodě 25,25, která je získána vyřešením soustavy rovnic pomocí funkce solve</span></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">solve</span>(A, b) </span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">25</span>; j <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x[(i<span class="dv">-2</span>)<span class="sc">*</span><span class="dv">48</span><span class="sc">+</span>j<span class="dv">-1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25.851134611833032295</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">#modeluje nám fyzikální jevy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="průbeh-funkce-hledání-extrémů" class="level3">
<h3 class="anchored" data-anchor-id="průbeh-funkce-hledání-extrémů">Průbeh funkce (hledání extrémů)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { <span class="fu">return</span>(<span class="fu">cos</span>(<span class="dv">5</span><span class="sc">*</span><span class="fu">acos</span>(x)))} <span class="co">#nadefinujeme si funkci</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="co">#uděláme první a druhou derivaci funkce</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="cf">function</span>(f,x, <span class="at">h=</span><span class="fl">1e-5</span>){<span class="fu">return</span>((<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="fu">f</span>(x<span class="sc">-</span>h))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>h))} <span class="co">#první derivace (centrální difference), k aproximaci první derivace (přesnější než dopředná) </span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>fdd <span class="ot">&lt;-</span> <span class="cf">function</span>(f,x, <span class="at">h=</span><span class="fl">1e-5</span>){<span class="fu">return</span>((<span class="fu">f</span>(x<span class="sc">+</span>h)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">f</span>(x)<span class="sc">-</span><span class="fu">f</span>(x<span class="sc">-</span>h))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>h))} <span class="co">#druhá derivace (pomocí centrální difference)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="hledání-extrémů" class="level4">
<h4 class="anchored" data-anchor-id="hledání-extrémů">Hledání extrémů</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">#najdem extremy, kde f'(x)=0 v celé funkci od -1 do 1</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>x_hodnoty <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">100000</span>)<span class="co">#rozsah x a i vytvoření osy k interpolaci, lenght.out je citlivost zaznamenávání extrémů (zde musí být vykoká)</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>derivace <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_hodnoty, <span class="cf">function</span>(x) <span class="fu">fd</span>(f,x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in acos(x): NaNs produced
Warning in acos(x): NaNs produced</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>extremy <span class="ot">&lt;-</span> x_hodnoty[<span class="fu">which</span>(<span class="fu">abs</span>(derivace)<span class="sc">&lt;</span><span class="fl">1e-3</span>)] <span class="co">#vyfiltrujeme hodnoty přibližné 0 aby zbyly extrémy</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>extremy <span class="ot">&lt;-</span> x_hodnoty[<span class="fu">which</span>(<span class="fu">diff</span>(<span class="fu">sign</span>(derivace)) <span class="sc">!=</span> <span class="dv">0</span>)] <span class="co">#vymažu stejné hodnoty</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co">#rozlišíme minima a maxima podle druhé derivace, podle toho jestli je &lt;&gt;</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>druhe_derivace <span class="ot">&lt;-</span> <span class="fu">sapply</span>(extremy, <span class="cf">function</span>(x) <span class="fu">fdd</span>(f,x,<span class="at">h=</span><span class="fl">1e-1</span>))</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>typy_extremu <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(druhe_derivace<span class="sc">&gt;</span><span class="dv">0</span>,<span class="st">"Minimum"</span>,<span class="st">"Maximum"</span>)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(extremy) <span class="co">#můžem si je vypsat pro kontrolu</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.80901809018090187209 -0.30903309033090331504  0.30901309013090139111
[4]  0.80899808998089972611</code></pre>
</div>
</div>
</section>
<section id="hledáme-kořeny-funkce-pomocí-bisekce" class="level4">
<h4 class="anchored" data-anchor-id="hledáme-kořeny-funkce-pomocí-bisekce">Hledáme kořeny funkce pomocí bisekce</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#najdeme kořeny pro řešení f(x)=0</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>bisekce <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b){</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  fa <span class="ot">&lt;-</span> <span class="fu">f</span>(a); fb <span class="ot">&lt;-</span> <span class="fu">f</span>(b) </span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fa<span class="sc">*</span>fb <span class="sc">&lt;</span> <span class="dv">0</span>){ </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">repeat</span>{</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>      c <span class="ot">&lt;-</span> (a<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span> </span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(c <span class="sc">==</span> a <span class="sc">||</span> c <span class="sc">==</span> b) <span class="fu">return</span>(c) </span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>      fc <span class="ot">&lt;-</span> <span class="fu">f</span>(c)</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(fa<span class="sc">*</span>fc <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>        b <span class="ot">&lt;-</span> c</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>        fb <span class="ot">&lt;-</span> fc </span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{ </span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>        a <span class="ot">&lt;-</span> c</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>        fa <span class="ot">&lt;-</span> fc</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{ <span class="fu">stop</span>(<span class="st">"Spatne vstupni zadani"</span>); <span class="fu">return</span>(<span class="cn">FALSE</span>) }</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a><span class="co">#hledání kořenů mezi intervaly v celý funkci od -1 do 1</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>koreny <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(x_hodnoty)<span class="sc">-</span><span class="dv">1</span>)){ <span class="co">#projdém iteraci délkou x hodnot</span></span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">f</span>(x_hodnoty[i])<span class="sc">*</span><span class="fu">f</span>(x_hodnoty[i<span class="sc">+</span><span class="dv">1</span>])<span class="sc">&lt;</span><span class="dv">0</span>){<span class="co">#zjišťuji jestli existuje v intervalu kořen</span></span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>    koren <span class="ot">&lt;-</span> <span class="fu">bisekce</span>(f,x_hodnoty[i],x_hodnoty[i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#přidání nalezen. kořene do vektoru pokud není NA</span></span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(koren)) koreny <span class="ot">&lt;-</span> <span class="fu">c</span>(koreny, koren)</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(koreny) <span class="co">#můžem si vypsat pro kontrolu</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -9.5105651629515364220e-01 -5.8778525229247335915e-01
[3] -4.9789962505148006012e-17  5.8778525229247313710e-01
[5]  9.5105651629515364220e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#vykreslení extrémů a kořenů</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x_hodnoty, <span class="fu">f</span>(x_hodnoty),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"green"</span>,<span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">"Numerické hledání extrémů a kořenů"</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"f(x)"</span>) <span class="co">#interpolace funkce</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(extremy,<span class="fu">f</span>(extremy),<span class="at">col=</span><span class="fu">ifelse</span>(typy_extremu <span class="sc">==</span> <span class="st">"Minimum"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(koreny, <span class="fu">f</span>(koreny), <span class="at">col=</span><span class="st">"purple"</span>, <span class="at">pch=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="dvojnásobný-integrál" class="level3">
<h3 class="anchored" data-anchor-id="dvojnásobný-integrál">Dvojnásobný integrál</h3>
<p><img src="images/clipboard-3323605318.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="do">##hledání p v dvojnásobném integrálu</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerická integrace metodou středního bodu</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>MidPointRule <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, n) {</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b <span class="sc">-</span> a) <span class="sc">/</span> n</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(a <span class="sc">+</span> h<span class="sc">/</span><span class="dv">2</span>, b <span class="sc">-</span> h<span class="sc">/</span><span class="dv">2</span>, <span class="at">length.out =</span> n)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(h <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">f</span>(x)))</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vnitřní integrál I(α) (0,2)</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>InnerIntegral <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha) {</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>alpha <span class="sc">*</span> x) <span class="sc">*</span> <span class="fu">sin</span>(x)</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">MidPointRule</span>(f, <span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> pi, <span class="dv">1000</span>))  <span class="co"># Numerická integrace přes x</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Vnější integrál J(p) (0,p)</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>OuterIntegral <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha) <span class="fu">InnerIntegral</span>(alpha)</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">MidPointRule</span>(g, <span class="dv">0</span>, p, <span class="dv">1000</span>))  <span class="co"># Numerická integrace přes α</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Hledání p tak, aby J(p) = 1.31848 (bisekční metoda)</span></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>FindP <span class="ot">&lt;-</span> <span class="cf">function</span>(target, p_min, p_max, <span class="at">tol =</span> <span class="fl">1e-5</span>) {</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(p_max <span class="sc">-</span> p_min) <span class="sc">&gt;</span> tol) {</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>    p_mid <span class="ot">&lt;-</span> (p_min <span class="sc">+</span> p_max) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>    J_mid <span class="ot">&lt;-</span> <span class="fu">OuterIntegral</span>(p_mid)</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (J_mid <span class="sc">&lt;</span> target) {</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>      p_min <span class="ot">&lt;-</span> p_mid</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>      p_max <span class="ot">&lt;-</span> p_mid</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((p_min <span class="sc">+</span> p_max) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Hledání p</span></span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>target_value <span class="ot">&lt;-</span> <span class="fl">1.31848</span></span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a>p_solution <span class="ot">&lt;-</span> <span class="fu">FindP</span>(target_value, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_solution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.9999952316284179687</code></pre>
</div>
</div>
</section>
<section id="řešení-soustavy-rovnic-a-dosazování-matice-a" class="level3">
<h3 class="anchored" data-anchor-id="řešení-soustavy-rovnic-a-dosazování-matice-a">Řešení soustavy rovnic a dosazování matice A</h3>
<p><img src="images/clipboard-1751264345.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n); y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>    A[i, j] <span class="ot">&lt;-</span> <span class="fu">cos</span>((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> j) <span class="sc">-</span> j</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> <span class="fu">sin</span>(i)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Řešení soustavy A * x = y</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>Gauss <span class="ot">&lt;-</span> <span class="cf">function</span>(A,b){ <span class="co">#řešení lineárních rovnic Ax = b</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(b); Ab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A,b) <span class="co">#uprava původní matice A do horní trojúhelnikové formy pomocí přímého chodu, řešení rovnice zpětným chodem pro přímý chod</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#přímý chod (pro každý sloupec(k) zrušíme prvky pod diagonálou násobem a odečítáním řádků, výsledkem je (horní trojúhelníková matice pro zpětný chod)</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#pivot - můžem dát pro vylepšení</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>    max_row <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">abs</span>(Ab[(k<span class="sc">:</span>n),k]))<span class="sc">+</span>k<span class="dv">-1</span> <span class="co">#(maximální prvek v akt sloupci pod nebo na diagonale)</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(max_row <span class="sc">!=</span> k){</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> k<span class="sc">:</span>(n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">&lt;-</span> Ab[k,j]</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>      Ab[k,j] <span class="ot">&lt;-</span> Ab[max_row,j]</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>      Ab[max_row,j] <span class="ot">&lt;-</span> temp</span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>      c <span class="ot">&lt;-</span> <span class="sc">-</span>Ab[i,k]<span class="sc">/</span>Ab[k,k]</span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a>      Ab[i,j] <span class="ot">&lt;-</span> Ab[i,j] <span class="sc">+</span> c<span class="sc">*</span>Ab[k,j]</span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb163-26"><a href="#cb163-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb163-27"><a href="#cb163-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#zpětný chod (počítáme neznámé, začínáme od posledního řádku a postupujeme nahoru, postupně počítáme neznámé x pomocí horní trojúhelníkové matice)</span></span>
<span id="cb163-28"><a href="#cb163-28" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> b</span>
<span id="cb163-29"><a href="#cb163-29" aria-hidden="true" tabindex="-1"></a>  x[n] <span class="ot">&lt;-</span> Ab[n,n<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span>Ab[n,n]</span>
<span id="cb163-30"><a href="#cb163-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb163-31"><a href="#cb163-31" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> (Ab[i,n<span class="sc">+</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(Ab[i,(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]<span class="sc">*</span>x[(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]))<span class="sc">/</span>Ab[i,i]</span>
<span id="cb163-32"><a href="#cb163-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb163-33"><a href="#cb163-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x) <span class="co">#vektor x, který je řešení soustavy lin. rovnic</span></span>
<span id="cb163-34"><a href="#cb163-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-35"><a href="#cb163-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">solve</span>(A, y)); <span class="fu">print</span>(<span class="fu">Gauss</span>(A,y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1.339109442371420044537 -1.130513917316488203824 -0.524337194762319547259
 [4]  1.532726843025794538633 -0.760031422869154926758  0.431100835613461019769
 [7]  0.011557672485774377058  0.554577004976064880104  2.201428299075885774982
[10] -2.659850350665447393794</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1.339109442371412272976 -1.130513917316468219809 -0.524337194762310776497
 [4]  1.532726843025765672834 -0.760031422869148265420  0.431100835613453081674
 [7]  0.011557672485779964602  0.554577004976054999119  2.201428299075846695132
[10] -2.659850350665401652606</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">Gauss</span>(A,y)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Interpolace polynomem p(x)</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>polyfit <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, deg) {</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, deg, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">coef</span>(fit))</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>NewtonPolCoef <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){ <span class="co">#vektor bodů na ose x a y(mnoziny bodů)</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); coef <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co">#vytvoření prázdného vektoru</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>  coef[<span class="dv">1</span>] <span class="ot">&lt;-</span> y[<span class="dv">1</span>] <span class="co">#první coef c1 a y1</span></span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>){ </span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>      suma <span class="ot">&lt;-</span> coef[<span class="dv">1</span>]; nasobic <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>)){</span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>        nasobic <span class="ot">&lt;-</span> nasobic<span class="sc">*</span>(x[i]<span class="sc">-</span>x[j])</span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>        suma <span class="ot">&lt;-</span> suma <span class="sc">+</span> coef[j]<span class="sc">*</span>nasobic</span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>      } <span class="co">#metoda dělených rozdílů, koeficienty c[i] jsou počítány iterativně pomocí dělených rozdílů a předchozích výsledků.</span></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a>      coef[i] <span class="ot">&lt;-</span> (y[i]<span class="sc">-</span>suma)<span class="sc">/</span>nasobic</span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a>    } <span class="co">#c jsou koef. získané pomocí dělených rozdílů</span></span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(coef) <span class="co">#Vektor koeficientů Newtnova polynomu</span></span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a><span class="co">#pol. P(t)=c1+c2(t-x1)+c3(t-x1)(t-x2)+...+cn-1(t-x1)(t-x2)...(t-xn-1)</span></span>
<span id="cb166-23"><a href="#cb166-23" aria-hidden="true" tabindex="-1"></a>NewtonPolValue <span class="ot">&lt;-</span> <span class="cf">function</span>(t,x,coef){<span class="co">#t-bod,kde hodnotíme polynom.x: uzly na ose x, coef: koeficienty pol. vypoc. funkcí NewtonPolCoef.</span></span>
<span id="cb166-24"><a href="#cb166-24" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n] <span class="co">#Začíná od posledního koeficientu cn</span></span>
<span id="cb166-25"><a href="#cb166-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb166-26"><a href="#cb166-26" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res<span class="sc">*</span>(t<span class="sc">-</span>x[i])<span class="sc">+</span>coef[i]<span class="co">#Newtonův polynom je vyjádřen v rekurzivním tvaru s využitím základních polynomů P(t)</span></span>
<span id="cb166-27"><a href="#cb166-27" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb166-28"><a href="#cb166-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota polynomu v bodech t P(t)</span></span>
<span id="cb166-29"><a href="#cb166-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-30"><a href="#cb166-30" aria-hidden="true" tabindex="-1"></a>LSA <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, n){ <span class="co">#x a y jevektor hodnot, n je stupeň polynomu</span></span>
<span id="cb166-31"><a href="#cb166-31" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n); b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co">#vytvoření matice A a vektoru b</span></span>
<span id="cb166-32"><a href="#cb166-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb166-33"><a href="#cb166-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb166-34"><a href="#cb166-34" aria-hidden="true" tabindex="-1"></a>      <span class="co">#A je matice součtů mocnin x</span></span>
<span id="cb166-35"><a href="#cb166-35" aria-hidden="true" tabindex="-1"></a>      A[i,j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(x<span class="sc">^</span>{i<span class="sc">+</span>j<span class="dv">-2</span>}) </span>
<span id="cb166-36"><a href="#cb166-36" aria-hidden="true" tabindex="-1"></a>    }<span class="co">#b je vektor součtů součinů yx^i-1</span></span>
<span id="cb166-37"><a href="#cb166-37" aria-hidden="true" tabindex="-1"></a>    b[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y<span class="sc">*</span>x<span class="sc">^</span>{i<span class="dv">-1</span>}) <span class="co"># součty součinů y*x^(i-1)</span></span>
<span id="cb166-38"><a href="#cb166-38" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#vyřeší se lin. soustava rovnic LS: A*c=b což</span></span>
<span id="cb166-39"><a href="#cb166-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">solve</span>(A, b)) <span class="co"># vrátí vektor koeficientů c (aprox. polynomu)</span></span>
<span id="cb166-40"><a href="#cb166-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-41"><a href="#cb166-41" aria-hidden="true" tabindex="-1"></a><span class="co">#pol. je obecně vyjádř. ve tvaru: P(x)=anx^n+an-1x^n-1+…+a1x+a0</span></span>
<span id="cb166-42"><a href="#cb166-42" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(x,coef){ <span class="co">#vyhodnocení polynomu pomocí tvaru funkce: P(x)=(…((anx+an-1)x+an-2)*x+…+a1)x+a0, kde tento přístup minimalizuje počet násobení a sčítání (operací) při výpočtu hodnoty polynomu</span></span>
<span id="cb166-43"><a href="#cb166-43" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n] <span class="co">#Výpočet začíná od nejvyššího koef.</span></span>
<span id="cb166-44"><a href="#cb166-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) { <span class="co">#pro každý koef. od an-1 po a0 akt. res=res*x+ai</span></span>
<span id="cb166-45"><a href="#cb166-45" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res<span class="sc">*</span>x<span class="sc">+</span>coef[i] <span class="co">#se postupně přidává k dalším koeficientům tak, že každý mezivýsledek res násobíme x a přičítáme další koef.</span></span>
<span id="cb166-46"><a href="#cb166-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb166-47"><a href="#cb166-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota polynomů pro dané x</span></span>
<span id="cb166-48"><a href="#cb166-48" aria-hidden="true" tabindex="-1"></a>}<span class="co"># vhodné pouze pro hodnocení polynomu</span></span>
<span id="cb166-49"><a href="#cb166-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-50"><a href="#cb166-50" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb166-51"><a href="#cb166-51" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb166-52"><a href="#cb166-52" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,<span class="fu">NewtonPolValue</span>(t,x,<span class="fu">NewtonPolCoef</span>(x,y)),<span class="at">col=</span><span class="st">"orange"</span>) <span class="co">#newtonova interpolace</span></span>
<span id="cb166-53"><a href="#cb166-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Najdeme průsečík s osou y</span></span>
<span id="cb166-54"><a href="#cb166-54" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fu">LSA</span>(x,y,<span class="dv">5</span>)</span>
<span id="cb166-55"><a href="#cb166-55" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="fu">Horner</span>(x, coef), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lw =</span> <span class="dv">2</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb166-56"><a href="#cb166-56" aria-hidden="true" tabindex="-1"></a>polyval <span class="ot">&lt;-</span> <span class="cf">function</span>(coef, x) {</span>
<span id="cb166-57"><a href="#cb166-57" aria-hidden="true" tabindex="-1"></a>  deg <span class="ot">&lt;-</span> <span class="fu">length</span>(coef) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb166-58"><a href="#cb166-58" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x, <span class="cf">function</span>(xi) <span class="fu">sum</span>(coef <span class="sc">*</span> xi<span class="sc">^</span>(deg<span class="sc">:</span><span class="dv">0</span>)))</span>
<span id="cb166-59"><a href="#cb166-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb166-60"><a href="#cb166-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-61"><a href="#cb166-61" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">'blue'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Výpočet integrálu polynomu</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="fu">min</span>(x); x_max <span class="ot">&lt;-</span> <span class="fu">max</span>(x)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerická integrace metodou středního bodu</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>MidPointRule <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, n) {</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b <span class="sc">-</span> a) <span class="sc">/</span> n</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(a <span class="sc">+</span> h<span class="sc">/</span><span class="dv">2</span>, b <span class="sc">-</span> h<span class="sc">/</span><span class="dv">2</span>, <span class="at">length.out =</span> n)</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(h <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">f</span>(x)))</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>p_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { <span class="fu">Horner</span>(x,coef) }</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>integral_value <span class="ot">&lt;-</span> <span class="fu">MidPointRule</span>(p_function, x_min, x_max, <span class="dv">1000</span>)</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hodnota integrálu:"</span>, integral_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hodnota integrálu: 0.40180117577684409946 </code></pre>
</div>
</div>
</section>
<section id="dosazování-rovnic-s-určitým-interálem" class="level3">
<h3 class="anchored" data-anchor-id="dosazování-rovnic-s-určitým-interálem">Dosazování rovnic s určitým interálem<img src="images/clipboard-695776346.png" class="img-fluid"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">#výpočet integrálu</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>simpsons_rule <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b <span class="sc">-</span> a) <span class="sc">/</span> n</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(a, b, <span class="at">length.out =</span> n <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">f</span>(x)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((h <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">*</span> (y[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">sum</span>(y[<span class="fu">seq</span>(<span class="dv">2</span>, n, <span class="at">by =</span> <span class="dv">2</span>)]) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(y[<span class="fu">seq</span>(<span class="dv">3</span>, n<span class="dv">-1</span>, <span class="at">by =</span> <span class="dv">2</span>)]) <span class="sc">+</span> y[n <span class="sc">+</span> <span class="dv">1</span>]))</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="co"># výpočet matice A</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>construct_A <span class="ot">&lt;-</span> <span class="cf">function</span>(N) {</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>N, <span class="at">ncol=</span>N)</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>      f <span class="ot">&lt;-</span> <span class="cf">function</span>(t) t<span class="sc">^</span>(i <span class="sc">+</span> j <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>      A[i, j] <span class="ot">&lt;-</span> <span class="fu">simpsons_rule</span>(f, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a><span class="co"># výpočet vektoru b</span></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>construct_b <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rowSums</span>(A))  <span class="co"># Sum across rows</span></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a><span class="co">#výpočty hodnot matic pro n</span></span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (N <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">construct_A</span>(N)</span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">construct_b</span>(A)</span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>  svd_A <span class="ot">=</span> <span class="fu">svd</span>(A)</span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> svd_A<span class="sc">$</span>v <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> svd_A<span class="sc">$</span>d) <span class="sc">%*%</span> <span class="fu">t</span>(svd_A<span class="sc">$</span>u) <span class="sc">%*%</span> b</span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-30"><a href="#cb169-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-31"><a href="#cb169-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]) <span class="co">#prvních 10 řešení pro n=1...10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   1.00000006705522537231   0.99996280670166015625   1.00131225585937500000
 [4]   0.97265625000000000000   1.41796875000000000000  -2.20312500000000000000
 [7]   4.37500000000000000000 -16.62500000000000000000  23.50000000000000000000
[10]   5.50000000000000000000</code></pre>
</div>
</div>
</section>
<section id="num-integrace-pomocí-newton-cotesových-vzorců" class="level2">
<h2 class="anchored" data-anchor-id="num-integrace-pomocí-newton-cotesových-vzorců">Num integrace pomocí Newton-Cotesových vzorců<img src="images/clipboard-783473762.png" class="img-fluid"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Definice funkce a analytické řešení</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { <span class="dv">1</span><span class="sc">/</span>x }         <span class="co"># integrujeme f(x) = x</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>IA <span class="ot">&lt;-</span> (b<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>          <span class="co"># analytické řešení integrálu</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Analytické řešení ="</span>, IA, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analytické řešení = 1.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Lichoběžníkové pravidlo</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>TrapezoidalRule <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, n) {</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b <span class="sc">-</span> a) <span class="sc">/</span> n</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">f</span>(a) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">f</span>(b)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> s <span class="sc">+</span> <span class="fu">f</span>(a <span class="sc">+</span> k <span class="sc">*</span> h)</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(h <span class="sc">*</span> s)</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Smyčka pro n = 2^i, i=0..20</span></span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>I_num <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">21</span>)   <span class="co"># sem uložíme numerické výsledky</span></span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">21</span>)       <span class="co"># sem uložíme chyby</span></span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>i</span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>  I_num[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">TrapezoidalRule</span>(f, a, b, n)</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a>  y[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> I_num[i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">-</span> IA</span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Vykreslení výsledků</span></span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a><span class="co"># chyba y(i) v závislosti na i</span></span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, y, <span class="at">type=</span><span class="st">"b"</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">xlab=</span><span class="st">"i (n = 2^i)"</span>, <span class="at">ylab=</span><span class="st">"y(i) = I_N - I_A"</span>, <span class="at">main=</span><span class="st">"Chyba lichoběžníkové metody"</span>)</span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># volitelně: logaritmický graf chyby</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">log10</span>(<span class="fu">abs</span>(y)), <span class="at">type=</span><span class="st">"b"</span>, <span class="at">col=</span><span class="st">"darkgreen"</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">xlab=</span><span class="st">"i (n = 2^i)"</span>, <span class="at">ylab=</span><span class="st">"log10(|chyba|)"</span>, <span class="at">main=</span><span class="st">"Pokles chyby vs. i (očekáváme sklon -2)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-62-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="řešení-soustavy-lin.-rovnic-pomocí-interpolace-polynomem" class="level2">
<h2 class="anchored" data-anchor-id="řešení-soustavy-lin.-rovnic-pomocí-interpolace-polynomem">Řešení soustavy lin. rovnic pomocí interpolace polynomem<img src="images/clipboard-3312456677.png" class="img-fluid"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkce na sestavení matice A</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>makeA <span class="ot">&lt;-</span> <span class="cf">function</span>(N) {</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>N, <span class="at">ncol=</span>N)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>      A[i,j] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>(i<span class="sc">+</span>j<span class="dv">-1</span>)</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Newtonova interpolace</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>newton_coef <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); coef <span class="ot">&lt;-</span> y</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n<span class="sc">:</span>j) {</span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>      coef[i] <span class="ot">&lt;-</span> (coef[i] <span class="sc">-</span> coef[i<span class="dv">-1</span>]) <span class="sc">/</span> (x[i] <span class="sc">-</span> x[i<span class="sc">-</span>j<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(coef)</span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a>newton_eval <span class="ot">&lt;-</span> <span class="cf">function</span>(coef, x_nodes, x) {</span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef)</span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> coef[n]</span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> result <span class="sc">*</span> (x <span class="sc">-</span> x_nodes[i]) <span class="sc">+</span> coef[i]</span>
<span id="cb175-26"><a href="#cb175-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-27"><a href="#cb175-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb175-28"><a href="#cb175-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-29"><a href="#cb175-29" aria-hidden="true" tabindex="-1"></a>Gauss <span class="ot">&lt;-</span> <span class="cf">function</span>(A,b){ <span class="co">#řešení lineárních rovnic Ax = b</span></span>
<span id="cb175-30"><a href="#cb175-30" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(b); Ab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A,b) <span class="co">#uprava původní matice A do horní trojúhelnikové formy pomocí přímého chodu, řešení rovnice zpětným chodem pro přímý chod</span></span>
<span id="cb175-31"><a href="#cb175-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#přímý chod (pro každý sloupec(k) zrušíme prvky pod diagonálou násobem a odečítáním řádků, výsledkem je (horní trojúhelníková matice pro zpětný chod)</span></span>
<span id="cb175-32"><a href="#cb175-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb175-33"><a href="#cb175-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">#pivot - můžem dát pro vylepšení</span></span>
<span id="cb175-34"><a href="#cb175-34" aria-hidden="true" tabindex="-1"></a>    max_row <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">abs</span>(Ab[(k<span class="sc">:</span>n),k]))<span class="sc">+</span>k<span class="dv">-1</span> <span class="co">#(maximální prvek v akt sloupci pod nebo na diagonale)</span></span>
<span id="cb175-35"><a href="#cb175-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(max_row <span class="sc">!=</span> k){</span>
<span id="cb175-36"><a href="#cb175-36" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> k<span class="sc">:</span>(n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb175-37"><a href="#cb175-37" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">&lt;-</span> Ab[k,j]</span>
<span id="cb175-38"><a href="#cb175-38" aria-hidden="true" tabindex="-1"></a>      Ab[k,j] <span class="ot">&lt;-</span> Ab[max_row,j]</span>
<span id="cb175-39"><a href="#cb175-39" aria-hidden="true" tabindex="-1"></a>      Ab[max_row,j] <span class="ot">&lt;-</span> temp</span>
<span id="cb175-40"><a href="#cb175-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb175-41"><a href="#cb175-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb175-42"><a href="#cb175-42" aria-hidden="true" tabindex="-1"></a>      c <span class="ot">&lt;-</span> <span class="sc">-</span>Ab[i,k]<span class="sc">/</span>Ab[k,k]</span>
<span id="cb175-43"><a href="#cb175-43" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb175-44"><a href="#cb175-44" aria-hidden="true" tabindex="-1"></a>      Ab[i,j] <span class="ot">&lt;-</span> Ab[i,j] <span class="sc">+</span> c<span class="sc">*</span>Ab[k,j]</span>
<span id="cb175-45"><a href="#cb175-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb175-46"><a href="#cb175-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-47"><a href="#cb175-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">#zpětný chod (počítáme neznámé, začínáme od posledního řádku a postupujeme nahoru, postupně počítáme neznámé x pomocí horní trojúhelníkové matice)</span></span>
<span id="cb175-48"><a href="#cb175-48" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> b</span>
<span id="cb175-49"><a href="#cb175-49" aria-hidden="true" tabindex="-1"></a>  x[n] <span class="ot">&lt;-</span> Ab[n,n<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span>Ab[n,n]</span>
<span id="cb175-50"><a href="#cb175-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb175-51"><a href="#cb175-51" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> (Ab[i,n<span class="sc">+</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(Ab[i,(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]<span class="sc">*</span>x[(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]))<span class="sc">/</span>Ab[i,i]</span>
<span id="cb175-52"><a href="#cb175-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-53"><a href="#cb175-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x) <span class="co">#vektor x, který je řešení soustavy lin. rovnic</span></span>
<span id="cb175-54"><a href="#cb175-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-55"><a href="#cb175-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Hlavní výpočet</span></span>
<span id="cb175-56"><a href="#cb175-56" aria-hidden="true" tabindex="-1"></a>solve_system <span class="ot">&lt;-</span> <span class="cf">function</span>(N) {</span>
<span id="cb175-57"><a href="#cb175-57" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">makeA</span>(N)</span>
<span id="cb175-58"><a href="#cb175-58" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, N)</span>
<span id="cb175-59"><a href="#cb175-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vyřešíme soustavu</span></span>
<span id="cb175-60"><a href="#cb175-60" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">Gauss</span>(A, b)</span>
<span id="cb175-61"><a href="#cb175-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(x)</span>
<span id="cb175-62"><a href="#cb175-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb175-63"><a href="#cb175-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vykreslení řešení</span></span>
<span id="cb175-64"><a href="#cb175-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>N, x, <span class="at">type=</span><span class="st">"b"</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Reseni pro N ="</span>, N), <span class="at">xlab=</span><span class="st">"i"</span>, <span class="at">ylab=</span><span class="st">"x[i]"</span>)</span>
<span id="cb175-65"><a href="#cb175-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># interpolace</span></span>
<span id="cb175-66"><a href="#cb175-66" aria-hidden="true" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> <span class="fu">newton_coef</span>(<span class="dv">1</span><span class="sc">:</span>N, x)</span>
<span id="cb175-67"><a href="#cb175-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># hodnoty uprostřed</span></span>
<span id="cb175-68"><a href="#cb175-68" aria-hidden="true" tabindex="-1"></a>  mids <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.5</span>, N<span class="fl">-0.5</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb175-69"><a href="#cb175-69" aria-hidden="true" tabindex="-1"></a>  mid_vals <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mids, <span class="cf">function</span>(xx) <span class="fu">newton_eval</span>(coef, <span class="dv">1</span><span class="sc">:</span>N, xx))</span>
<span id="cb175-70"><a href="#cb175-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(mids, mid_vals, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">pch=</span><span class="dv">19</span>)  <span class="co"># přidáme červené body</span></span>
<span id="cb175-71"><a href="#cb175-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">mids=</span>mids, <span class="at">mid_vals=</span>mid_vals))</span>
<span id="cb175-72"><a href="#cb175-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-73"><a href="#cb175-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Spuštění pro N = 10</span></span>
<span id="cb175-74"><a href="#cb175-74" aria-hidden="true" tabindex="-1"></a>x10 <span class="ot">&lt;-</span> <span class="fu">solve_system</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -1.0109416131481591128e-01  1.0007240136308894308e+01
 [3] -2.4015343164873078762e+02  2.4280525954723243558e+03
 [5] -1.2746561714442463199e+04  3.8237890492005935813e+04
 [7] -6.7975760525881574721e+04  7.0747852785765528096e+04
 [9] -3.9794478984524517729e+04  9.3342627376036634811e+03</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>x20 <span class="ot">&lt;-</span> <span class="fu">solve_system</span>(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -6.2004622133922805693e-02  9.0855136594134364714e+00
 [3] -3.2532384247678737665e+02  4.9378140153045496845e+03
 [5] -3.9035451799663678685e+04  1.7562385061193630099e+05
 [7] -4.5713822474960517138e+05  6.3474771563690446782e+05
 [9] -2.7941253846056392650e+05 -3.2409477482047566446e+05
[11]  2.3701304271642517415e+05  4.2620484988616366170e+05
[13] -7.1681385136363422496e+05  5.7999933942896942608e+05
[15] -7.6292882192156714154e+04 -6.1110814093425357713e+05
[17]  2.6141177571790548972e+05  8.1781633509650989433e+05
[19] -9.0565882757646380919e+05  2.7211727321879123338e+05</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-63-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpolace-polynomu-pomocí-rovnice-závislosti" class="level2">
<h2 class="anchored" data-anchor-id="interpolace-polynomu-pomocí-rovnice-závislosti">Interpolace polynomu pomocí rovnice závislosti</h2>
<p><img src="images/clipboard-2844794057.png" class="img-fluid"></p>
<p><img src="images/clipboard-2855822629.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.28</span>, <span class="fl">0.41</span>, <span class="fl">0.98</span>, <span class="fl">1.39</span>, <span class="fl">1.93</span>, <span class="fl">2.75</span>, <span class="fl">3.01</span>, <span class="fl">3.51</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.089</span>, <span class="fl">0.127</span>, <span class="fl">0.144</span>, <span class="fl">0.163</span>, <span class="fl">0.189</span>, <span class="fl">0.198</span>, <span class="fl">0.206</span>, <span class="fl">0.208</span>, <span class="fl">0.209</span>, <span class="fl">0.210</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">t</span>(<span class="fu">setNames</span>(<span class="fu">data.frame</span>(p, a), <span class="fu">c</span>(<span class="st">"$p$ [MPa]"</span>, <span class="st">"$a$"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(p\)</span> [MPa]</td>
<td style="text-align: right;">0.100000000000000005551</td>
<td style="text-align: right;">0.20000000000000001110</td>
<td style="text-align: right;">0.28000000000000002665</td>
<td style="text-align: right;">0.40999999999999997558</td>
<td style="text-align: right;">0.97999999999999998224</td>
<td style="text-align: right;">1.38999999999999990230</td>
<td style="text-align: right;">1.92999999999999993783</td>
<td style="text-align: right;">2.75000000000000000000</td>
<td style="text-align: right;">3.00999999999999978684</td>
<td style="text-align: right;">3.50999999999999978684</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(a\)</span></td>
<td style="text-align: right;">0.088999999999999995781</td>
<td style="text-align: right;">0.12700000000000000178</td>
<td style="text-align: right;">0.14399999999999998912</td>
<td style="text-align: right;">0.16300000000000000600</td>
<td style="text-align: right;">0.18900000000000000133</td>
<td style="text-align: right;">0.19800000000000000933</td>
<td style="text-align: right;">0.20599999999999998868</td>
<td style="text-align: right;">0.20799999999999999045</td>
<td style="text-align: right;">0.20899999999999999134</td>
<td style="text-align: right;">0.20999999999999999223</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, a, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">xlab=</span><span class="st">"p [MPa]"</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>Vandermonde <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span>n,<span class="at">ncol=</span>n)</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){ <span class="co">#pro kaž. bod(xi,yi) platí že hodnota P(xi) se musí=yi</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>    A[,j] <span class="ot">&lt;-</span> A[,j<span class="dv">-1</span>]<span class="sc">*</span>x <span class="co">#to vede k lin. soustavě rovnic a*c=y</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#c - vektor koeficientú, y - vektor hodnot</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">solve</span>(A,y)) <span class="co">#vektor c koeficientů interp. polynomu stupně n-1</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a><span class="co">#pol. je obecně vyjádř. ve tvaru: P(x)=anx^n+an-1x^n-1+…+a1x+a0</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(x,coef){ <span class="co">#vyhodnocení polynomu pomocí tvaru funkce: P(x)=(…((anx+an-1)x+an-2)*x+…+a1)x+a0, kde tento přístup minimalizuje počet násobení a sčítání (operací) při výpočtu hodnoty polynomu</span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n] <span class="co">#Výpočet začíná od nejvyššího koef.</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) { <span class="co">#pro každý koef. od an-1 po a0 akt. res=res*x+ai</span></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res<span class="sc">*</span>x<span class="sc">+</span>coef[i] <span class="co">#se postupně přidává k dalším koeficientům tak, že každý mezivýsledek res násobíme x a přičítáme další koef.</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota polynomů pro dané x</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>}<span class="co"># vhodné pouze pro hodnocení polynomu</span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>NewtonPolCoef <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){ <span class="co">#vektor bodů na ose x a y(mnoziny bodů)</span></span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); coef <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co">#vytvoření prázdného vektoru</span></span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>  coef[<span class="dv">1</span>] <span class="ot">&lt;-</span> y[<span class="dv">1</span>] <span class="co">#první coef c1 a y1</span></span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>){ </span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a>      suma <span class="ot">&lt;-</span> coef[<span class="dv">1</span>]; nasobic <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>)){</span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a>        nasobic <span class="ot">&lt;-</span> nasobic<span class="sc">*</span>(x[i]<span class="sc">-</span>x[j])</span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a>        suma <span class="ot">&lt;-</span> suma <span class="sc">+</span> coef[j]<span class="sc">*</span>nasobic</span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a>      } <span class="co">#metoda dělených rozdílů, koeficienty c[i] jsou počítány iterativně pomocí dělených rozdílů a předchozích výsledků.</span></span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true" tabindex="-1"></a>      coef[i] <span class="ot">&lt;-</span> (y[i]<span class="sc">-</span>suma)<span class="sc">/</span>nasobic</span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true" tabindex="-1"></a>    } <span class="co">#c jsou koef. získané pomocí dělených rozdílů</span></span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb180-31"><a href="#cb180-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(coef) <span class="co">#Vektor koeficientů Newtnova polynomu</span></span>
<span id="cb180-32"><a href="#cb180-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb180-33"><a href="#cb180-33" aria-hidden="true" tabindex="-1"></a><span class="co">#pol. P(t)=c1+c2(t-x1)+c3(t-x1)(t-x2)+...+cn-1(t-x1)(t-x2)...(t-xn-1)</span></span>
<span id="cb180-34"><a href="#cb180-34" aria-hidden="true" tabindex="-1"></a>NewtonPolValue <span class="ot">&lt;-</span> <span class="cf">function</span>(t,x,coef){<span class="co">#t-bod,kde hodnotíme polynom.x: uzly na ose x, coef: koeficienty pol. vypoc. funkcí NewtonPolCoef.</span></span>
<span id="cb180-35"><a href="#cb180-35" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n] <span class="co">#Začíná od posledního koeficientu cn</span></span>
<span id="cb180-36"><a href="#cb180-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb180-37"><a href="#cb180-37" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res<span class="sc">*</span>(t<span class="sc">-</span>x[i])<span class="sc">+</span>coef[i]<span class="co">#Newtonův polynom je vyjádřen v rekurzivním tvaru s využitím základních polynomů P(t)</span></span>
<span id="cb180-38"><a href="#cb180-38" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb180-39"><a href="#cb180-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co">#hodnota polynomu v bodech t P(t)</span></span>
<span id="cb180-40"><a href="#cb180-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb180-41"><a href="#cb180-41" aria-hidden="true" tabindex="-1"></a>Lagrange <span class="ot">&lt;-</span> <span class="cf">function</span>(t,x,y){ <span class="co">#počítáme bod t, kde chceme spočítat intepolaci, x jsou body dané na ose x, y jsou uzly na ose y (vektor) </span></span>
<span id="cb180-42"><a href="#cb180-42" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); suma <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb180-43"><a href="#cb180-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb180-44"><a href="#cb180-44" aria-hidden="true" tabindex="-1"></a>    nasobic <span class="ot">&lt;-</span> <span class="dv">1</span><span class="co">#jsou použity jako váhy pro příslušné základní polynomy</span></span>
<span id="cb180-45"><a href="#cb180-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb180-46"><a href="#cb180-46" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(j<span class="sc">!=</span>i){ <span class="co">#pro j!= 0</span></span>
<span id="cb180-47"><a href="#cb180-47" aria-hidden="true" tabindex="-1"></a>        nasobic <span class="ot">&lt;-</span> nasobic<span class="sc">*</span>(t<span class="sc">-</span>x[j])<span class="sc">/</span>(x[i]<span class="sc">-</span>x[j]) <span class="co">#Lagrangeův základní polynom Li(t), která se skládá z násobků (t-xj)/(xi-xj), kde j se nerovná i. </span></span>
<span id="cb180-48"><a href="#cb180-48" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb180-49"><a href="#cb180-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb180-50"><a href="#cb180-50" aria-hidden="true" tabindex="-1"></a>    suma <span class="ot">&lt;-</span> suma<span class="sc">+</span>y[i]<span class="sc">*</span>nasobic <span class="co">#suma hodnot všech základních polynomů násobených odpovídající hodnotou y[i]</span></span>
<span id="cb180-51"><a href="#cb180-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb180-52"><a href="#cb180-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(suma) <span class="co">#hodnota interpolovaneho polynomu v bodech t stupně n-1</span></span>
<span id="cb180-53"><a href="#cb180-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb180-54"><a href="#cb180-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-55"><a href="#cb180-55" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(p),<span class="fu">max</span>(p),<span class="at">by=</span><span class="fl">0.001</span>) <span class="co">#celá čára (místo by můžem použít leght.out)</span></span>
<span id="cb180-56"><a href="#cb180-56" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,<span class="fu">Horner</span>(t, <span class="fu">Vandermonde</span>(p,a)),<span class="at">col=</span><span class="st">"green"</span>, <span class="at">lwd=</span><span class="dv">1</span>) </span>
<span id="cb180-57"><a href="#cb180-57" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,<span class="fu">NewtonPolValue</span>(t,p,<span class="fu">NewtonPolCoef</span>(p,a)),<span class="at">col=</span><span class="st">"orange"</span>)</span>
<span id="cb180-58"><a href="#cb180-58" aria-hidden="true" tabindex="-1"></a><span class="co">#points(t, Lagrange(t, p, a),col="red", pch=20, cex=0.5)</span></span>
<span id="cb180-59"><a href="#cb180-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Nonlinear Least Squares Fit</span></span>
<span id="cb180-60"><a href="#cb180-60" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">nls</span>(a <span class="sc">~</span> (am <span class="sc">*</span> b <span class="sc">*</span> p) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> b <span class="sc">*</span> p), <span class="at">start =</span> <span class="fu">list</span>(<span class="at">am =</span> <span class="fl">0.22</span>, <span class="at">b =</span> <span class="dv">1</span>))</span>
<span id="cb180-61"><a href="#cb180-61" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb180-62"><a href="#cb180-62" aria-hidden="true" tabindex="-1"></a>am_est <span class="ot">&lt;-</span> params[<span class="st">"am"</span>]</span>
<span id="cb180-63"><a href="#cb180-63" aria-hidden="true" tabindex="-1"></a>b_est <span class="ot">&lt;-</span> params[<span class="st">"b"</span>]</span>
<span id="cb180-64"><a href="#cb180-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpolating Polynomial (Using Polynomial Regression)</span></span>
<span id="cb180-65"><a href="#cb180-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a sequence for smooth plotting</span></span>
<span id="cb180-66"><a href="#cb180-66" aria-hidden="true" tabindex="-1"></a>p_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(p), <span class="fu">max</span>(p), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb180-67"><a href="#cb180-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute values from the fitted model</span></span>
<span id="cb180-68"><a href="#cb180-68" aria-hidden="true" tabindex="-1"></a>a_model <span class="ot">&lt;-</span> (am_est <span class="sc">*</span> b_est <span class="sc">*</span> p_seq) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> b_est <span class="sc">*</span> p_seq) <span class="co">#analytické vyjádření závislosti a(p)</span></span>
<span id="cb180-69"><a href="#cb180-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot data</span></span>
<span id="cb180-70"><a href="#cb180-70" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(p, a, col="red", pch=16, xlab="p [MPa]", ylab="a", main="Data, Model Fit, and Interpolation")</span></span>
<span id="cb180-71"><a href="#cb180-71" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p_seq, a_model, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">1</span>)  <span class="co"># Model Fit</span></span>
<span id="cb180-72"><a href="#cb180-72" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Data"</span>, <span class="st">"Model Fit"</span>, <span class="st">"Polynomial Interpolation"</span>), </span>
<span id="cb180-73"><a href="#cb180-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print estimated parameters</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Estimated am:"</span>, <span class="fu">round</span>(am_est, <span class="dv">4</span>))); <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Estimated b:"</span>, <span class="fu">round</span>(b_est, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Estimated am: 0.2192"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Estimated b: 6.8744"</code></pre>
</div>
</div>
</section>
<section id="řešení-integrace-pomocí-rovnice-1.-řádu" class="level2">
<h2 class="anchored" data-anchor-id="řešení-integrace-pomocí-rovnice-1.-řádu">Řešení integrace pomocí rovnice 1. řádu</h2>
<p><img src="images/clipboard-1140800261.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) { <span class="fu">return</span>(y <span class="sc">-</span> x) } <span class="co"># y' = y - x</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>RK4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,f,h){ <span class="co">#4 mezikroky k dosažení vyšší přesnosti, má velmi malou chybu i při větších krocích. Bere totiž v úvahu. derivace na začátku, uprostřed a na konci intervalu.</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  hhalf <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>h</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  k1 <span class="ot">&lt;-</span> <span class="fu">f</span>(x,y)</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>  k2 <span class="ot">&lt;-</span> <span class="fu">f</span>(x<span class="sc">+</span>hhalf,y<span class="sc">+</span>hhalf<span class="sc">*</span>k1)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  k3 <span class="ot">&lt;-</span> <span class="fu">f</span>(x<span class="sc">+</span>hhalf,y<span class="sc">+</span>hhalf<span class="sc">*</span>k2)</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>  k4 <span class="ot">&lt;-</span> <span class="fu">f</span>(x<span class="sc">+</span>h,y<span class="sc">+</span>h<span class="sc">*</span>k3)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (y<span class="sc">+</span>((h<span class="sc">/</span><span class="dv">6</span>)<span class="sc">*</span>(k1<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>(k2<span class="sc">+</span>k3)<span class="sc">+</span>k4)))</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>RK4_solve <span class="ot">&lt;-</span> <span class="cf">function</span>(x0, y0, f, h, x_end) {</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>  x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(x0, x_end, <span class="at">by =</span> h)</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>  y_vals <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x_vals))</span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>  y_vals[<span class="dv">1</span>] <span class="ot">&lt;-</span> y0</span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x_vals)) {</span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>    y_vals[i] <span class="ot">&lt;-</span> <span class="fu">RK4</span>(x_vals[i<span class="dv">-1</span>], y_vals[i<span class="dv">-1</span>], f, h)</span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x_vals, <span class="at">y =</span> y_vals))</span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a>bisekce <span class="ot">&lt;-</span> <span class="cf">function</span>(target_integral, <span class="at">tol =</span> <span class="fl">1e-4</span>) {</span>
<span id="cb184-20"><a href="#cb184-20" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">0</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span>; max_iter <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb184-21"><a href="#cb184-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb184-22"><a href="#cb184-22" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> (a <span class="sc">+</span> b) <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># Střed intervalu</span></span>
<span id="cb184-23"><a href="#cb184-23" aria-hidden="true" tabindex="-1"></a>    sol <span class="ot">&lt;-</span> <span class="fu">RK4_solve</span>(<span class="dv">0</span>, c, f, <span class="at">h =</span> <span class="fl">0.001</span>, <span class="at">x_end =</span> <span class="dv">1</span>)  <span class="co"># Řešíme ODE pomocí RK4</span></span>
<span id="cb184-24"><a href="#cb184-24" aria-hidden="true" tabindex="-1"></a>    integral_approx <span class="ot">&lt;-</span> <span class="fu">sum</span>(sol<span class="sc">$</span>y) <span class="sc">*</span> <span class="fl">0.01</span>  <span class="co"># Přibližný integrál</span></span>
<span id="cb184-25"><a href="#cb184-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(integral_approx <span class="sc">-</span> target_integral) <span class="sc">&lt;</span> tol) {</span>
<span id="cb184-26"><a href="#cb184-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">y0 =</span> c, <span class="at">solution =</span> sol))  <span class="co"># Našli jsme správné y(0)</span></span>
<span id="cb184-27"><a href="#cb184-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb184-28"><a href="#cb184-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (integral_approx <span class="sc">&gt;</span> target_integral) { b <span class="ot">&lt;-</span> c } </span>
<span id="cb184-29"><a href="#cb184-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { a <span class="ot">&lt;-</span> c }</span>
<span id="cb184-30"><a href="#cb184-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb184-31"><a href="#cb184-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb184-32"><a href="#cb184-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb184-33"><a href="#cb184-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Najdeme správnou počáteční podmínku</span></span>
<span id="cb184-34"><a href="#cb184-34" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; x <span class="ot">&lt;-</span> <span class="dv">0</span>; y <span class="ot">&lt;-</span> <span class="dv">1</span>; h<span class="ot">=</span><span class="fl">0.01</span></span>
<span id="cb184-35"><a href="#cb184-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb184-36"><a href="#cb184-36" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">RK4</span>(x, y, f, h)</span>
<span id="cb184-37"><a href="#cb184-37" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">+</span> h</span>
<span id="cb184-38"><a href="#cb184-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"x ="</span>, x, <span class="st">", y ="</span>, y, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb184-39"><a href="#cb184-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x = 0.010000000000000000208 , y = 1.0100000000000000089 
x = 0.020000000000000000416 , y = 1.0200000000000000178 
x = 0.02999999999999999889 , y = 1.0300000000000000266 
x = 0.040000000000000000833 , y = 1.0400000000000000355 
x = 0.050000000000000002776 , y = 1.0500000000000000444 
x = 0.060000000000000004718 , y = 1.0600000000000000533 
x = 0.070000000000000006661 , y = 1.0700000000000000622 
x = 0.080000000000000001665 , y = 1.0800000000000000711 
x = 0.089999999999999996669 , y = 1.0900000000000000799 
x = 0.099999999999999991673 , y = 1.1000000000000000888 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">bisekce</span>(<span class="dv">2</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>y0)  <span class="co"># Hodnota y(0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.243377685546875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result<span class="sc">$</span>solution<span class="sc">$</span>x, result<span class="sc">$</span>solution<span class="sc">$</span>y, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">"Řešení ODE metodou bisekce"</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y(x)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#N &lt;- 10; tMax &lt;- 2; dt &lt;- tMax/N; t &lt;- dt*(0:N) #casova sekvence</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co">#n0 &lt;- 300; n &lt;- t; n[1] &lt;- n0</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co">#nRK4 &lt;- numeric(length(t)); nRK4[1] &lt;- n0</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co">#for(i in 1:N) nRK4[i+1] &lt;- RK4(t[i], nRK4[i],f, dt)</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(t, nRK4, col='violet', type='l', lwd=2,</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     main="Řešení ODE s počáteční podmínkou n0=300", </span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     xlab="t", ylab="n(t)")</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co">#points(t, nRK4, col='violet', pch=19)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="van-der-waals-stavová-rovnice" class="level2">
<h2 class="anchored" data-anchor-id="van-der-waals-stavová-rovnice">Van der Waals stavová rovnice</h2>
<p><img src="images/clipboard-3631751192.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkce pro výpočet redukovaného tlaku</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>vdw_pressure <span class="ot">&lt;-</span> <span class="cf">function</span>(Vr, Tr) {</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> (<span class="dv">8</span> <span class="sc">*</span> Tr) <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">*</span> Vr <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">/</span> Vr<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pr)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Definujeme rozsah redukovaných objemů</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>Vr_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">3.0</span>, <span class="at">by =</span> <span class="fl">0.0001</span>)</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Redukovaná teplota (z grafu vidíme Tr = 0.89)</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>Tr <span class="ot">&lt;-</span> <span class="fl">0.89</span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Vypočítáme redukované tlaky</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>pr_values <span class="ot">&lt;-</span> <span class="fu">vdw_pressure</span>(Vr_range, Tr)</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Vytvoříme dataframe pro plotting</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Vr =</span> Vr_range, <span class="at">pr =</span> pr_values)</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Vykreslíme graf</span></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd=</span><span class="dv">2</span>,</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Reduced volume"</span>, <span class="at">ylab=</span><span class="st">"Reduced pressure"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.6</span>))</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>y_line <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.6</span>, <span class="fl">2.6</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>y_vals <span class="ot">&lt;-</span> <span class="fu">rep</span>(y_line, <span class="fu">length</span>(x_vals))</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_vals, y_vals, <span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Najdeme minimum (pokud existuje)</span></span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>min_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(pr_values)</span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>min_Vr <span class="ot">&lt;-</span> Vr_range[min_index]; min_pr <span class="ot">&lt;-</span> pr_values[min_index]</span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Minimum je při Vr ="</span>, min_Vr, <span class="st">"a pr ="</span>, min_pr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum je při Vr = 0.7079999999999999627 a pr = 0.34964932494071465641 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerické řešení pro konkrétní tlak</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>target_pressure <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="co"># Například najdeme Vr pro pr = 0.6</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Definujeme funkci pro root finding</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>pressure_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(Vr) { <span class="fu">vdw_pressure</span>(Vr, Tr) <span class="sc">-</span> target_pressure }</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Použijeme uniroot pro nalezení kořenů</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Můžeme mít více řešení, takže hledáme v různých intervalech</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>root1 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(pressure_diff, <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>))<span class="sc">$</span>root</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>root2 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(pressure_diff, <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">3.0</span>))<span class="sc">$</span>root</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pro pr ="</span>, target_pressure, <span class="st">"máme Vr ="</span>, root1, <span class="st">"nebo Vr ="</span>, root2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pro pr = 0.5999999999999999778 máme Vr = 0.59435582330995617717 nebo Vr = 2.6271817592244222084 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ověříme výsledky</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kontrola: pr("</span>, root1, <span class="st">") ="</span>, <span class="fu">vdw_pressure</span>(root1, Tr), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kontrola: pr( 0.59435582330995617717 ) = 0.60009130987594971884 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kontrola: pr("</span>, root2, <span class="st">") ="</span>, <span class="fu">vdw_pressure</span>(root2, Tr), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kontrola: pr( 2.6271817592244222084 ) = 0.60000000213145987527 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Body pro vykreslení</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>Vr <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">vdw_pressure</span>(Vr, Tr)</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>Vr1 <span class="ot">&lt;-</span> root1</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>Vr2 <span class="ot">&lt;-</span> root2</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> Vr <span class="sc">&gt;=</span> Vr1 <span class="sc">&amp;</span> Vr <span class="sc">&lt;=</span> Vr2</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(Vr[idx], <span class="fu">rev</span>(Vr[idx])),</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(pr[idx], <span class="fu">rep</span>(y_line, <span class="fu">sum</span>(idx))),</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="fl">0.8</span>,<span class="fl">0.3</span>), <span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Oblast nad čarou (mimo interval Vr1-&gt;Vr2)</span></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>idx2 <span class="ot">&lt;-</span> Vr <span class="sc">&lt;=</span> Vr1 <span class="sc">|</span> Vr <span class="sc">&gt;=</span> Vr2</span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(Vr[idx2], <span class="fu">rev</span>(Vr[idx2])),</span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(pr[idx2], <span class="fu">rep</span>(y_line, <span class="fu">sum</span>(idx2))),</span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>), <span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Derivace</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>dpr_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(Vr, Tr) { <span class="sc">-</span><span class="dv">24</span><span class="sc">*</span>Tr <span class="sc">/</span> (<span class="dv">3</span><span class="sc">*</span>Vr <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">6</span> <span class="sc">/</span> Vr<span class="sc">^</span><span class="dv">3</span> }</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Najdi extrémy pomocí uniroot</span></span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>Vr_min <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(dpr_fun, <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>), <span class="at">Tr=</span>Tr)<span class="sc">$</span>root</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>Vr_max <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(dpr_fun, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">Tr=</span>Tr)<span class="sc">$</span>root</span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Hodnoty tlaku</span></span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>pr_min <span class="ot">&lt;-</span> <span class="fu">vdw_pressure</span>(Vr_min, Tr); pr_max <span class="ot">&lt;-</span> <span class="fu">vdw_pressure</span>(Vr_max, Tr)</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Minimum: Vr ="</span>, Vr_min, <span class="st">"pr ="</span>, pr_min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum: Vr = 0.70805489563539381059 pr = 0.34964931633157814161 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Maximum: Vr ="</span>, Vr_max, <span class="st">"pr ="</span>, pr_max, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum: Vr = 1.5668632591603370852 pr = 0.7020518106750737175 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(Vr_min, Vr_max), <span class="fu">c</span>(pr_min, pr_max), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>), <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="dv">8</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>,<span class="at">lty=</span><span class="st">"solid"</span>)</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Minimum"</span>,<span class="st">"Maximum"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>), <span class="at">pch=</span><span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hledání-a-interpolování-konce-b-v-integrálu" class="level2">
<h2 class="anchored" data-anchor-id="hledání-a-interpolování-konce-b-v-integrálu">Hledání a interpolování konce b v integrálu</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2); <span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gridExtra' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lagrange - Lagrangeova interpolace</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>Lagrange <span class="ot">&lt;-</span> <span class="cf">function</span>(t, x, y){ <span class="co"># počítáme bod t, kde chceme spočítat interpolaci, x jsou body dané na ose x, y jsou uzly na ose y (vektor) </span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); suma <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>    nasobic <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># jsou použity jako váhy pro příslušné základní polynomy</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(j<span class="sc">!=</span>i){ <span class="co"># pro j!= i</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>        nasobic <span class="ot">&lt;-</span> nasobic<span class="sc">*</span>(t<span class="sc">-</span>x[j])<span class="sc">/</span>(x[i]<span class="sc">-</span>x[j]) <span class="co"># Lagrangeův základní polynom Li(t), která se skládá z násobků (t-xj)/(xi-xj), kde j se nerovná i. </span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>    suma <span class="ot">&lt;-</span> suma<span class="sc">+</span>y[i]<span class="sc">*</span>nasobic <span class="co"># suma hodnot všech základních polynomů násobených odpovídající hodnotou y[i]</span></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(suma) <span class="co"># hodnota interpolovaného polynomu v bodech t stupně n-1</span></span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a><span class="co"># LSA - Metoda nejmenších čtverců pro polynomiální aproximaci</span></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>LSA <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, n){ <span class="co"># x a y je vektor hodnot, n je stupeň polynomu</span></span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n); b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co"># vytvoření matice A a vektoru b</span></span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># A je matice součtů mocnin x</span></span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true" tabindex="-1"></a>      A[i,j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(x<span class="sc">^</span>(i<span class="sc">+</span>j<span class="dv">-2</span>)) </span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true" tabindex="-1"></a>    } <span class="co"># b je vektor součtů součinů yx^i-1</span></span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true" tabindex="-1"></a>    b[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y<span class="sc">*</span>x<span class="sc">^</span>(i<span class="dv">-1</span>)) <span class="co"># součty součinů y*x^(i-1)</span></span>
<span id="cb205-24"><a href="#cb205-24" aria-hidden="true" tabindex="-1"></a>  } <span class="co"># vyřeší se lin. soustava rovnic LS: A*c=b což</span></span>
<span id="cb205-25"><a href="#cb205-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">solve</span>(A, b)) <span class="co"># vrátí vektor koeficientů c (aprox. polynomu)</span></span>
<span id="cb205-26"><a href="#cb205-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb205-27"><a href="#cb205-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Horner - vyhodnocení polynomu pomocí Hornerova schématu</span></span>
<span id="cb205-28"><a href="#cb205-28" aria-hidden="true" tabindex="-1"></a><span class="co"># pol. je obecně vyjádř. ve tvaru: P(x)=anx^n+an-1x^n-1+…+a1x+a0</span></span>
<span id="cb205-29"><a href="#cb205-29" aria-hidden="true" tabindex="-1"></a>Horner <span class="ot">&lt;-</span> <span class="cf">function</span>(x, coef){ <span class="co"># vyhodnocení polynomu pomocí tvaru funkce: P(x)=(…((anx+an-1)x+an-2)*x+…+a1)x+a0</span></span>
<span id="cb205-30"><a href="#cb205-30" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(coef); res <span class="ot">&lt;-</span> coef[n] <span class="co"># Výpočet začíná od nejvyššího koef.</span></span>
<span id="cb205-31"><a href="#cb205-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (n<span class="dv">-1</span>)<span class="sc">:</span><span class="dv">1</span>) { <span class="co"># pro každý koef. od an-1 po a0 akt. res=res*x+ai</span></span>
<span id="cb205-32"><a href="#cb205-32" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> res<span class="sc">*</span>x<span class="sc">+</span>coef[i] <span class="co"># se postupně přidává k dalším koeficientům</span></span>
<span id="cb205-33"><a href="#cb205-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb205-34"><a href="#cb205-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res) <span class="co"># hodnota polynomů pro dané x</span></span>
<span id="cb205-35"><a href="#cb205-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb205-36"><a href="#cb205-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-37"><a href="#cb205-37" aria-hidden="true" tabindex="-1"></a><span class="co">#definování funkce integrálu</span></span>
<span id="cb205-38"><a href="#cb205-38" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { <span class="fu">return</span>( <span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">+</span>pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)) }</span>
<span id="cb205-39"><a href="#cb205-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-40"><a href="#cb205-40" aria-hidden="true" tabindex="-1"></a><span class="co">#simpsnovo pravidlo pro výpočet integrálu</span></span>
<span id="cb205-41"><a href="#cb205-41" aria-hidden="true" tabindex="-1"></a>simpson_integration <span class="ot">&lt;-</span> <span class="cf">function</span>(f, a, b, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb205-42"><a href="#cb205-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">1</span>) n <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># n musí být sudé</span></span>
<span id="cb205-43"><a href="#cb205-43" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b <span class="sc">-</span> a) <span class="sc">/</span> n</span>
<span id="cb205-44"><a href="#cb205-44" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(a, b, <span class="at">length.out =</span> n <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb205-45"><a href="#cb205-45" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x, f)</span>
<span id="cb205-46"><a href="#cb205-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb205-47"><a href="#cb205-47" aria-hidden="true" tabindex="-1"></a>  integral <span class="ot">&lt;-</span> h<span class="sc">/</span><span class="dv">3</span> <span class="sc">*</span> (y[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">sum</span>(y[<span class="fu">seq</span>(<span class="dv">2</span>, n, <span class="at">by =</span> <span class="dv">2</span>)]) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(y[<span class="fu">seq</span>(<span class="dv">3</span>, n<span class="dv">-1</span>, <span class="at">by =</span> <span class="dv">2</span>)]) <span class="sc">+</span> y[n<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb205-48"><a href="#cb205-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(integral)</span>
<span id="cb205-49"><a href="#cb205-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb205-50"><a href="#cb205-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-51"><a href="#cb205-51" aria-hidden="true" tabindex="-1"></a><span class="co">#hledání hodnoty b pomocí bisekce</span></span>
<span id="cb205-52"><a href="#cb205-52" aria-hidden="true" tabindex="-1"></a>find_b_for_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(f, <span class="at">target_value =</span> <span class="fl">0.05</span>) {</span>
<span id="cb205-53"><a href="#cb205-53" aria-hidden="true" tabindex="-1"></a>  initial_guess <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.5</span> <span class="sc">+</span> target_value)  <span class="co"># 0.5 je P(X &lt; 0)</span></span>
<span id="cb205-54"><a href="#cb205-54" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">0</span>; b <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">3</span>, initial_guess <span class="sc">+</span> <span class="dv">1</span>); tolerance <span class="ot">&lt;-</span> <span class="fl">1e-8</span>; max_iter <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb205-55"><a href="#cb205-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb205-56"><a href="#cb205-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb205-57"><a href="#cb205-57" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> (a <span class="sc">+</span> b) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb205-58"><a href="#cb205-58" aria-hidden="true" tabindex="-1"></a>    integral_c <span class="ot">&lt;-</span> <span class="fu">simpson_integration</span>(f, <span class="dv">0</span>, c)</span>
<span id="cb205-59"><a href="#cb205-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(integral_c <span class="sc">-</span> target_value) <span class="sc">&lt;</span> tolerance) { <span class="fu">return</span>(c) }</span>
<span id="cb205-60"><a href="#cb205-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb205-61"><a href="#cb205-61" aria-hidden="true" tabindex="-1"></a>    integral_a <span class="ot">&lt;-</span> <span class="fu">simpson_integration</span>(f, <span class="dv">0</span>, a)</span>
<span id="cb205-62"><a href="#cb205-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ((integral_a <span class="sc">-</span> target_value) <span class="sc">*</span> (integral_c <span class="sc">-</span> target_value) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb205-63"><a href="#cb205-63" aria-hidden="true" tabindex="-1"></a>      b <span class="ot">&lt;-</span> c</span>
<span id="cb205-64"><a href="#cb205-64" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb205-65"><a href="#cb205-65" aria-hidden="true" tabindex="-1"></a>      a <span class="ot">&lt;-</span> c</span>
<span id="cb205-66"><a href="#cb205-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb205-67"><a href="#cb205-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb205-68"><a href="#cb205-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(c)</span>
<span id="cb205-69"><a href="#cb205-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb205-70"><a href="#cb205-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-71"><a href="#cb205-71" aria-hidden="true" tabindex="-1"></a>b_value <span class="ot">&lt;-</span> <span class="fu">find_b_for_integral</span>(f, <span class="fl">0.05</span>)</span>
<span id="cb205-72"><a href="#cb205-72" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hodnota b pro integrál = 0.05:"</span>, <span class="fu">round</span>(b_value, <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hodnota b pro integrál = 0.05: 0.11361899999999999777 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>verification <span class="ot">&lt;-</span> <span class="fu">simpson_integration</span>(f, <span class="dv">0</span>, b_value)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ověření výsledku - integrál od 0 do b:"</span>, <span class="fu">round</span>(verification, <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ověření výsledku - integrál od 0 do b: 0.050000000000000002776 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Graf normální distribuce s vyznačením oblasti</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>x_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.01</span>); y_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_range, f)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Oblast integrace</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>x_integral <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, b_value, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>y_integral <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_integral, f)</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_range, <span class="at">y =</span> y_values), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_integral, <span class="at">y =</span> y_integral), <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> b_value, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Normální distribuce - Oblast integrálu = 0.05"</span>),</span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"b ="</span>, <span class="fu">round</span>(b_value, <span class="dv">4</span>)),</span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"f(x)"</span>) <span class="sc">+</span></span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> b_value<span class="sc">/</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="st">"0.05"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Výpočet hodnot pro interpolaci a aproximaci</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>x_points <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="at">by =</span> <span class="fl">0.05</span>)  <span class="co"># 0.05, 0.10, 0.15, 0.20, 0.25</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>y_points <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_points, f)</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Vytvoření tabulky hodnot</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>data_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x_points,</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_points,</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">integral_0_to_x =</span> <span class="fu">sapply</span>(x_points, <span class="cf">function</span>(xi) <span class="fu">find_b_for_integral</span>(f, xi))</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Tabulka hodnot pro interpolaci:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Tabulka hodnot pro interpolaci:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        x                      y        integral_0_to_x
1 0.050000000000000002776 0.44046185015760974668 0.11361940205097198486
2 0.100000000000000005551 0.43881321134928247263 0.22872966527938842773
3 0.150000000000000022204 0.43607918152139252266 0.34696376323699951172
4 0.200000000000000011102 0.43228013375574025901 0.47027568519115447998
5 0.250000000000000000000 0.42744423518396462702 0.60121379792690277100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Lineární interpolace</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>x_fine <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>lagrange_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_fine, <span class="cf">function</span>(t) <span class="fu">Lagrange</span>(t, x_points, y_points))</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ověření interpolace v původních bodech:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ověření interpolace v původních bodech:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_points)) {</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  calculated <span class="ot">&lt;-</span> <span class="fu">Lagrange</span>(x_points[i], x_points, y_points)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"x=%.2f: očekáváno=%.6f, vypočteno=%.6f, chyba=%.2e</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>              x_points[i], y_points[i], calculated, <span class="fu">abs</span>(y_points[i] <span class="sc">-</span> calculated)))</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x=0.05: očekáváno=0.440462, vypočteno=0.440462, chyba=0.00e+00
x=0.10: očekáváno=0.438813, vypočteno=0.438813, chyba=0.00e+00
x=0.15: očekáváno=0.436079, vypočteno=0.436079, chyba=0.00e+00
x=0.20: očekáváno=0.432280, vypočteno=0.432280, chyba=0.00e+00
x=0.25: očekáváno=0.427444, vypočteno=0.427444, chyba=0.00e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Polynomiální aproximace (3. stupně)</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>x_fine <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>degree_4 <span class="ot">&lt;-</span> <span class="fu">LSA</span>(x_points, y_points, <span class="dv">5</span>)  <span class="co"># polynom 4. stupně (5 koeficienty)</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Stupeň 4:"</span>, <span class="fu">paste</span>(<span class="fu">round</span>(degree_4, <span class="dv">6</span>), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stupeň 4: 0.441013, 1.1e-05, -0.220681, 0.001184, 0.05196 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>poly_4_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_fine, <span class="cf">function</span>(x) <span class="fu">Horner</span>(x, degree_4))</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pro porovnání - vestavěná funkce R</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>poly_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_points <span class="sc">~</span> <span class="fu">poly</span>(x_points, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>poly_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(poly_fit, <span class="fu">data.frame</span>(<span class="at">x_points =</span> x_fine))</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Původní funkce</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_fine, <span class="at">y =</span> <span class="fu">sapply</span>(x_fine, f)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Interpolace a aproximace</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_fine, <span class="at">y =</span> lagrange_values), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_fine, <span class="at">y =</span> poly_4_values), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Body pro interpolaci</span></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_points, <span class="at">y =</span> y_points), <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porovnání interpolačních a aproximačních metod"</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"f(x)"</span>) <span class="sc">+</span></span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Metoda"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Původní funkce"</span> <span class="ot">=</span> <span class="st">"black"</span>, <span class="st">"Lagrangeova interpolace"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Polynomiální aproximace"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Kubická spline"</span> <span class="ot">=</span> <span class="st">"green"</span>)) <span class="sc">+</span></span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="num_v_jednom_files/figure-html/unnamed-chunk-67-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>